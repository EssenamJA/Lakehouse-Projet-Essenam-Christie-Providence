[0m10:57:17.969990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61D37D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61AEC4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61F4F3C50>]}


============================== 10:57:18.089907 | fd48457d-4f94-4d44-bd7f-fa4c4182f9dd ==============================
[0m10:57:18.089907 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:57:18.090729 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'use_colors': 'True', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m10:57:18.094350 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m10:57:18.095028 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "shop", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m10:57:18.096284 [debug] [MainThread]: Command `dbt build` failed at 10:57:18.095855 after 0.31 seconds
[0m10:57:18.096763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61E50F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61F550A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A61E39DBF0>]}
[0m10:57:18.097184 [debug] [MainThread]: Flushing usage events
[0m10:57:18.806482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:45.735660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C11BCD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C0F714190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C12D73C50>]}


============================== 10:58:45.739834 | 9799594d-8b0b-44fb-9715-f40636faadb4 ==============================
[0m10:58:45.739834 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:58:45.740545 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m10:58:45.743805 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m10:58:45.744532 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "shop", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m10:58:45.745388 [debug] [MainThread]: Command `dbt build` failed at 10:58:45.745287 after 0.18 seconds
[0m10:58:45.745660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C12D5F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C12DD0A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C12BEDBF0>]}
[0m10:58:45.745961 [debug] [MainThread]: Flushing usage events
[0m10:58:46.609549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:02.522095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32463D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D322184190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3257E3C50>]}


============================== 11:18:02.526242 | 84d0209d-c6db-4785-813b-6ffced22fb79 ==============================
[0m11:18:02.526242 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:18:02.527223 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m11:18:02.579402 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "wintershop", target "dev" invalid: '6543' is not of type 'integer'
[0m11:18:02.580616 [debug] [MainThread]: Command `dbt build` failed at 11:18:02.580471 after 0.24 seconds
[0m11:18:02.580928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D325875810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D326925250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32565EF10>]}
[0m11:18:02.581235 [debug] [MainThread]: Flushing usage events
[0m11:18:03.294459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:10.472106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B41239D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40FEE4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B414513C50>]}


============================== 11:21:10.476292 | 158f8e5d-999c-4df5-b3a9-d4ba1761c577 ==============================
[0m11:21:10.476292 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:21:10.477177 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'invocation_command': 'dbt build', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m11:21:10.688026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '158f8e5d-999c-4df5-b3a9-d4ba1761c577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B412831F30>]}
[0m11:21:10.741945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '158f8e5d-999c-4df5-b3a9-d4ba1761c577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4133BFDF0>]}
[0m11:21:10.743681 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:21:10.955451 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:21:10.956620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:21:10.957342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '158f8e5d-999c-4df5-b3a9-d4ba1761c577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B414C77650>]}
[0m11:21:12.680169 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.shop
[0m11:21:12.684777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158f8e5d-999c-4df5-b3a9-d4ba1761c577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4132BA7B0>]}
[0m11:21:12.718496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m11:21:12.725320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m11:21:13.413747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158f8e5d-999c-4df5-b3a9-d4ba1761c577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B416353CB0>]}
[0m11:21:13.414330 [info ] [MainThread]: Found 464 macros
[0m11:21:13.416103 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:21:13.417006 [debug] [MainThread]: Command end result
[0m11:21:13.432395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m11:21:13.435235 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m11:21:13.438325 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m11:21:13.438998 [debug] [MainThread]: Command `dbt build` succeeded at 11:21:13.438887 after 3.16 seconds
[0m11:21:13.439323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4151F7EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4131E7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B414F0F950>]}
[0m11:21:13.439631 [debug] [MainThread]: Flushing usage events
[0m11:21:14.114336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:39.868953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB62ED160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB3E34190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB8463C50>]}


============================== 14:16:39.875066 | 23e0a0fa-b614-4bda-9cce-2f861b829cc3 ==============================
[0m14:16:39.875066 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:16:39.875968 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m14:16:40.184188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e0a0fa-b614-4bda-9cce-2f861b829cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB6781F30>]}
[0m14:16:40.226830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e0a0fa-b614-4bda-9cce-2f861b829cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB730FDF0>]}
[0m14:16:40.228164 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:16:40.560385 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m14:16:40.604748 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:16:40.605548 [debug] [MainThread]: previous checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, current checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b
[0m14:16:40.605825 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:16:40.608674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23e0a0fa-b614-4bda-9cce-2f861b829cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB8C6A750>]}
[0m14:16:41.662746 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.shop
[0m14:16:41.666422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e0a0fa-b614-4bda-9cce-2f861b829cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB6351F40>]}
[0m14:16:41.693797 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m14:16:41.715783 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m14:16:41.752941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e0a0fa-b614-4bda-9cce-2f861b829cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB8D88750>]}
[0m14:16:41.753605 [info ] [MainThread]: Found 464 macros
[0m14:16:41.754614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e0a0fa-b614-4bda-9cce-2f861b829cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB8C77450>]}
[0m14:16:41.756859 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:16:41.759371 [debug] [MainThread]: Command end result
[0m14:16:41.773011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m14:16:41.774835 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m14:16:41.777469 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m14:16:41.778108 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:41.778012 after 2.05 seconds
[0m14:16:41.778361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB7137F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB8DE4D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB8DE4C00>]}
[0m14:16:41.778600 [debug] [MainThread]: Flushing usage events
[0m14:16:42.652776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:12.270710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E05CD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223DE114190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E1773C50>]}


============================== 14:32:12.274298 | 48bf2052-895b-44be-a35c-f39134a3dfdc ==============================
[0m14:32:12.274298 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:32:12.275110 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m14:32:12.404444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48bf2052-895b-44be-a35c-f39134a3dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E0A61F30>]}
[0m14:32:12.449295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48bf2052-895b-44be-a35c-f39134a3dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E15EFDF0>]}
[0m14:32:12.450855 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:32:12.595130 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m14:32:12.644248 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:32:12.645184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48bf2052-895b-44be-a35c-f39134a3dfdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E2F5A750>]}
[0m14:32:13.295027 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.wintershop.stg_logs' (models\silver\stg_logs.sql) depends on a source named 'bronze.bronze' which was not found
[0m14:32:13.296283 [debug] [MainThread]: Command `dbt run` failed at 14:32:13.296173 after 1.19 seconds
[0m14:32:13.296577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E2FB08C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E2FB0E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E1747E70>]}
[0m14:32:13.296807 [debug] [MainThread]: Flushing usage events
[0m14:32:14.014456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:56.042502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA3F1D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA1A64190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6093C50>]}


============================== 14:37:56.047561 | 1b51b84e-b16f-4122-9c4a-1b17b4f68b11 ==============================
[0m14:37:56.047561 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:37:56.048469 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m14:37:56.194342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA43ADF30>]}
[0m14:37:56.249167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA4F3FDF0>]}
[0m14:37:56.251104 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:37:56.437901 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m14:37:56.472884 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:37:56.473586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA695A750>]}
[0m14:37:57.203849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6630F50>]}
[0m14:37:57.244532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m14:37:57.246590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m14:37:57.268029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6D8FBD0>]}
[0m14:37:57.268448 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m14:37:57.269148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6DEB520>]}
[0m14:37:57.275214 [info ] [MainThread]: 
[0m14:37:57.275897 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m14:37:57.276626 [info ] [MainThread]: 
[0m14:37:57.277564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:57.278931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m14:38:00.379944 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m14:38:00.380242 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m14:38:00.380430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:00.553059 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.173 seconds
[0m14:38:00.554197 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m14:38:00.557284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m14:38:00.561242 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m14:38:00.561630 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m14:38:00.562063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:00.710038 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.148 seconds
[0m14:38:00.711788 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m14:38:00.744911 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m14:38:00.749782 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:00.750220 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:38:00.750465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:00.909035 [debug] [MainThread]: SQL status: SELECT 0 in 0.158 seconds
[0m14:38:00.910355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6CDB650>]}
[0m14:38:00.910914 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:00.926171 [debug] [MainThread]: On master: COMMIT
[0m14:38:00.926875 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:00.927372 [debug] [MainThread]: On master: COMMIT
[0m14:38:00.971334 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m14:38:00.972832 [debug] [MainThread]: On master: Close
[0m14:38:00.990197 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m14:38:00.990670 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m14:38:00.991558 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m14:38:00.991894 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m14:38:00.996592 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m14:38:00.998346 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m14:38:01.028149 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m14:38:01.030865 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m14:38:01.031203 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    select
    log
from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m14:38:01.031425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:01.204789 [debug] [Thread-1 (]: SQL status: SELECT 6761 in 0.173 seconds
[0m14:38:01.213527 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m14:38:01.213792 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m14:38:01.231358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m14:38:01.241900 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m14:38:01.242236 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m14:38:01.242460 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m14:38:01.272130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m14:38:01.277604 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m14:38:01.280485 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m14:38:01.280734 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m14:38:01.295818 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m14:38:01.297652 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m14:38:01.309688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b51b84e-b16f-4122-9c4a-1b17b4f68b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6C01700>]}
[0m14:38:01.310300 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 6761[0m in 0.31s]
[0m14:38:01.311290 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m14:38:01.314787 [debug] [MainThread]: On master: COMMIT
[0m14:38:01.315157 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:01.315426 [debug] [MainThread]: On master: COMMIT
[0m14:38:01.315627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:01.468219 [debug] [MainThread]: SQL status: COMMIT in 0.153 seconds
[0m14:38:01.468592 [debug] [MainThread]: On master: Close
[0m14:38:01.469000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:01.469221 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m14:38:01.469397 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m14:38:01.469554 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m14:38:01.469768 [info ] [MainThread]: 
[0m14:38:01.470325 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m14:38:01.471235 [debug] [MainThread]: Command end result
[0m14:38:01.482158 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m14:38:01.483903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m14:38:01.488030 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m14:38:01.488414 [info ] [MainThread]: 
[0m14:38:01.489218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:01.489971 [info ] [MainThread]: 
[0m14:38:01.490692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:38:01.492190 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:01.492013 after 5.61 seconds
[0m14:38:01.492682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6DA36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6FF8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6D7F0D0>]}
[0m14:38:01.493103 [debug] [MainThread]: Flushing usage events
[0m14:38:02.121700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:51.690077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B830F7D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B82EAC4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8330F3C50>]}


============================== 15:30:51.693868 | 35674744-6668-4751-b913-3ee972db7169 ==============================
[0m15:30:51.693868 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:30:51.694682 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profile essenam', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m15:30:51.822566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35674744-6668-4751-b913-3ee972db7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B831411F30>]}
[0m15:30:51.866597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35674744-6668-4751-b913-3ee972db7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B831F9FDF0>]}
[0m15:30:51.868179 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:30:52.004015 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m15:30:52.131009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:52.131546 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m15:30:52.306899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35674744-6668-4751-b913-3ee972db7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8339A8150>]}
[0m15:30:52.399686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m15:30:52.401603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m15:30:52.424648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35674744-6668-4751-b913-3ee972db7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B833107020>]}
[0m15:30:52.425081 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m15:30:52.425749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35674744-6668-4751-b913-3ee972db7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B833B6E190>]}
[0m15:30:52.427087 [info ] [MainThread]: 
[0m15:30:52.427694 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m15:30:52.428334 [info ] [MainThread]: 
[0m15:30:52.428961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:52.429768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m15:30:52.473220 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m15:30:52.473516 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m15:30:52.473721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:52.629429 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.156 seconds
[0m15:30:52.631496 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m15:30:52.633278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m15:30:52.638091 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m15:30:52.638669 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m15:30:52.639060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:52.777377 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.138 seconds
[0m15:30:52.780306 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m15:30:52.796250 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m15:30:52.800953 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:52.801406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:30:52.801761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:52.936980 [debug] [MainThread]: SQL status: SELECT 0 in 0.135 seconds
[0m15:30:52.939207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35674744-6668-4751-b913-3ee972db7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B833F106D0>]}
[0m15:30:52.939952 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:52.954623 [debug] [MainThread]: On master: COMMIT
[0m15:30:52.955365 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:52.955829 [debug] [MainThread]: On master: COMMIT
[0m15:30:52.984881 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m15:30:52.986128 [debug] [MainThread]: On master: Close
[0m15:30:52.999959 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m15:30:53.000423 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m15:30:53.001219 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m15:30:53.001511 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m15:30:53.006379 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m15:30:53.007459 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m15:30:53.035612 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m15:30:53.036525 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:30:53.036860 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    regexp_extract(log, '^([0-9\\.]+)') as ip,

    -- timestamp
    to_timestamp(
        regexp_extract(log, '\\[(.*?)\\]'),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- HTTP method
    regexp_extract(log, '"(GET|POST|PUT|DELETE)') as http_method,

    -- page
    regexp_extract(log, '"(GET|POST|PUT|DELETE) ([^ ]+)', 2) as page,

    -- status code
    regexp_extract(log, '" [0-9]{3} ', 0)::int as status_code,

    -- referer
    regexp_extract(log, '"(https?://[^"]+)"$', 1) as referer,

    -- source du trafic
    case
        when regexp_extract(log, '"(https?://[^"]+)"$', 1) ilike '%google%' then 'google'
        when regexp_extract(log, '"(https?://[^"]+)"$', 1) is null then 'direct'
        else 'other'
    end as traffic_source,

    -- device
    case
        when log ilike '%Mobile%' then 'mobile'
        else 'desktop'
    end as device

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m15:30:53.037143 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:53.180642 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function regexp_extract(text, unknown) does not exist
LINE 18:     regexp_extract(log, '^([0-9\\.]+)') as ip,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m15:30:53.181210 [debug] [Thread-1 (]: On model.wintershop.stg_logs: ROLLBACK
[0m15:30:53.196246 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m15:30:53.312724 [debug] [Thread-1 (]: Database Error in model stg_logs (models\silver\stg_logs.sql)
  function regexp_extract(text, unknown) does not exist
  LINE 18:     regexp_extract(log, '^([0-9\\.]+)') as ip,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m15:30:53.314619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35674744-6668-4751-b913-3ee972db7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B833FD47D0>]}
[0m15:30:53.315096 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wintershop_essenam.stg_logs .............. [[31mERROR[0m in 0.31s]
[0m15:30:53.316130 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m15:30:53.316604 [debug] [Thread-27 ]: Marking all children of 'model.wintershop.stg_logs' to be skipped because of status 'error'.  Reason: Database Error in model stg_logs (models\silver\stg_logs.sql)
  function regexp_extract(text, unknown) does not exist
  LINE 18:     regexp_extract(log, '^([0-9\\.]+)') as ip,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\wintershop\models\silver\stg_logs.sql.
[0m15:30:53.320737 [debug] [MainThread]: On master: COMMIT
[0m15:30:53.321217 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:53.321547 [debug] [MainThread]: On master: COMMIT
[0m15:30:53.321947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:53.464113 [debug] [MainThread]: SQL status: COMMIT in 0.142 seconds
[0m15:30:53.464630 [debug] [MainThread]: On master: Close
[0m15:30:53.465210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:53.465587 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m15:30:53.465924 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m15:30:53.466215 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m15:30:53.466589 [info ] [MainThread]: 
[0m15:30:53.467585 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m15:30:53.468882 [debug] [MainThread]: Command end result
[0m15:30:53.481965 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m15:30:53.484810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m15:30:53.489248 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m15:30:53.489558 [info ] [MainThread]: 
[0m15:30:53.490193 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:30:53.490871 [info ] [MainThread]: 
[0m15:30:53.491652 [error] [MainThread]: [31mFailure in model stg_logs (models\silver\stg_logs.sql)[0m
[0m15:30:53.492274 [error] [MainThread]:   Database Error in model stg_logs (models\silver\stg_logs.sql)
  function regexp_extract(text, unknown) does not exist
  LINE 18:     regexp_extract(log, '^([0-9\\.]+)') as ip,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m15:30:53.492935 [info ] [MainThread]: 
[0m15:30:53.493531 [info ] [MainThread]:   compiled code at target\compiled\wintershop\models\silver\stg_logs.sql
[0m15:30:53.494195 [info ] [MainThread]: 
[0m15:30:53.494921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:30:53.496397 [debug] [MainThread]: Command `dbt run` failed at 15:30:53.496241 after 1.95 seconds
[0m15:30:53.496744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B833A5E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B83398CC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B83398CB90>]}
[0m15:30:53.497093 [debug] [MainThread]: Flushing usage events
[0m15:30:54.135973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:22.139138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C697DCD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C695914190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C699F43C50>]}


============================== 15:32:22.142512 | a0b0b166-1804-4292-af07-7ece5091ad31 ==============================
[0m15:32:22.142512 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:32:22.143352 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m15:32:22.271502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0b0b166-1804-4292-af07-7ece5091ad31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69825DF30>]}
[0m15:32:22.323783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0b0b166-1804-4292-af07-7ece5091ad31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C698DEFDF0>]}
[0m15:32:22.325062 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:32:22.481214 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m15:32:22.590148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:32:22.590675 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m15:32:22.754935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0b0b166-1804-4292-af07-7ece5091ad31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69A748150>]}
[0m15:32:22.847300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m15:32:22.849282 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m15:32:22.872271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0b0b166-1804-4292-af07-7ece5091ad31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C699F57020>]}
[0m15:32:22.872752 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m15:32:22.873373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b0b166-1804-4292-af07-7ece5091ad31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69A90A190>]}
[0m15:32:22.874769 [info ] [MainThread]: 
[0m15:32:22.875328 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m15:32:22.875867 [info ] [MainThread]: 
[0m15:32:22.876464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:32:22.877661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m15:32:22.923161 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m15:32:22.923505 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m15:32:22.923756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:23.064358 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.141 seconds
[0m15:32:23.066015 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m15:32:23.068325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m15:32:23.073744 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m15:32:23.074047 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m15:32:23.074321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:23.226617 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.152 seconds
[0m15:32:23.229293 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m15:32:23.249253 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m15:32:23.257505 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:23.257793 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:32:23.258037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:23.421622 [debug] [MainThread]: SQL status: SELECT 0 in 0.163 seconds
[0m15:32:23.423996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b0b166-1804-4292-af07-7ece5091ad31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69ACC06D0>]}
[0m15:32:23.424794 [debug] [MainThread]: On master: ROLLBACK
[0m15:32:23.444977 [debug] [MainThread]: On master: COMMIT
[0m15:32:23.445661 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:23.446178 [debug] [MainThread]: On master: COMMIT
[0m15:32:23.475660 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m15:32:23.476624 [debug] [MainThread]: On master: Close
[0m15:32:23.491507 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m15:32:23.492044 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m15:32:23.492858 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m15:32:23.493200 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m15:32:23.499791 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m15:32:23.500692 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m15:32:23.527285 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m15:32:23.528919 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:32:23.529577 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    substring(log from '^([0-9\\.]+)') as ip,

    -- timestamp
    to_timestamp(
        substring(log from '\\[(.*?)\\]'),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- HTTP method
    substring(log from '"(GET|POST|PUT|DELETE)') as http_method,

    -- page
    substring(log from '"(GET|POST|PUT|DELETE) ([^ ]+)') as page,

    -- status code
    substring(log from '" ([0-9]{3}) ')::int as status_code,

    -- referer
    substring(log from '"(https?://[^"]+)"$') as referer,

    -- source du trafic
    case
        when substring(log from '"(https?://[^"]+)"$') ilike '%google%' then 'google'
        when substring(log from '"(https?://[^"]+)"$') is null then 'direct'
        else 'other'
    end as traffic_source,

    -- device
    case
        when log ilike '%Mobile%' then 'mobile'
        else 'desktop'
    end as device

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m15:32:23.529964 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:32:24.741688 [debug] [Thread-1 (]: SQL status: SELECT 8473 in 1.211 seconds
[0m15:32:24.751863 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:32:24.752348 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m15:32:24.768404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m15:32:24.771154 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:32:24.771611 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m15:32:24.791489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m15:32:24.807610 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m15:32:24.808225 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:32:24.808685 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m15:32:24.826329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m15:32:24.834126 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m15:32:24.838959 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:32:24.839402 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m15:32:24.859677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m15:32:24.862039 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m15:32:24.863886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0b0b166-1804-4292-af07-7ece5091ad31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69AD807D0>]}
[0m15:32:24.864418 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 8473[0m in 1.37s]
[0m15:32:24.865255 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m15:32:24.868037 [debug] [MainThread]: On master: COMMIT
[0m15:32:24.868308 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:24.868522 [debug] [MainThread]: On master: COMMIT
[0m15:32:24.868710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:25.005236 [debug] [MainThread]: SQL status: COMMIT in 0.136 seconds
[0m15:32:25.005740 [debug] [MainThread]: On master: Close
[0m15:32:25.006261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:25.006549 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m15:32:25.006800 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m15:32:25.007008 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m15:32:25.007258 [info ] [MainThread]: 
[0m15:32:25.008105 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m15:32:25.009778 [debug] [MainThread]: Command end result
[0m15:32:25.023331 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m15:32:25.025337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m15:32:25.031740 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m15:32:25.032616 [info ] [MainThread]: 
[0m15:32:25.033661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:25.034392 [info ] [MainThread]: 
[0m15:32:25.035171 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:32:25.036395 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:25.036270 after 3.06 seconds
[0m15:32:25.036704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69A7FD860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C694F940F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C698F61270>]}
[0m15:32:25.036992 [debug] [MainThread]: Flushing usage events
[0m15:32:25.661782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:04.590398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E597D8D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5958D4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E598F33C50>]}


============================== 15:57:04.594318 | afdd9c60-8564-46e6-8a13-81284808174e ==============================
[0m15:57:04.594318 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:57:04.595574 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m15:57:04.726274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afdd9c60-8564-46e6-8a13-81284808174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E598221F30>]}
[0m15:57:04.769583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afdd9c60-8564-46e6-8a13-81284808174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E598DAFDF0>]}
[0m15:57:04.770895 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:57:04.919973 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m15:57:05.019528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:05.020047 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m15:57:05.186713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afdd9c60-8564-46e6-8a13-81284808174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A798150>]}
[0m15:57:05.270383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m15:57:05.272237 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m15:57:05.292677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afdd9c60-8564-46e6-8a13-81284808174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E598F47020>]}
[0m15:57:05.293120 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m15:57:05.293844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afdd9c60-8564-46e6-8a13-81284808174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A95A190>]}
[0m15:57:05.295178 [info ] [MainThread]: 
[0m15:57:05.295767 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m15:57:05.296220 [info ] [MainThread]: 
[0m15:57:05.296864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:05.297623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m15:57:05.340487 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m15:57:05.340815 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m15:57:05.341048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:05.482886 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.142 seconds
[0m15:57:05.485568 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m15:57:05.488577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m15:57:05.493460 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m15:57:05.493742 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m15:57:05.493992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:05.647344 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.153 seconds
[0m15:57:05.649610 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m15:57:05.673447 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m15:57:05.680330 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.680813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:57:05.681170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:05.827298 [debug] [MainThread]: SQL status: SELECT 0 in 0.146 seconds
[0m15:57:05.830623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afdd9c60-8564-46e6-8a13-81284808174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59AD006D0>]}
[0m15:57:05.831522 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:05.849621 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.850724 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.851624 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.891103 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m15:57:05.892077 [debug] [MainThread]: On master: Close
[0m15:57:05.903020 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m15:57:05.903507 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m15:57:05.904208 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m15:57:05.904560 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m15:57:05.909738 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m15:57:05.911091 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m15:57:05.939876 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m15:57:05.940841 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:57:05.941256 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    substring(log from '^([0-9\\.]+)') as ip,

    -- timestamp
    to_timestamp(
        substring(log from '\\[(.*?)\\]'),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- HTTP method
    substring(log from '"(GET|POST|PUT|DELETE)') as http_method,

    -- page
    substring(log from '"(GET|POST|PUT|DELETE) ([^ ]+)') as page,

    -- status code
    substring(log from '" ([0-9]{3}) ')::int as status_code,

    -- referer : avant-dernière chaîne entre guillemets
    substring(
        log
        from '"(https?://[^"]+)"\\s+"[^"]+"$'
    ) as referer,

    -- user agent : dernière chaîne entre guillemets
    substring(
        log
        from '"([^"]+)"$'
    ) as user_agent

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m15:57:05.941582 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:06.915513 [debug] [Thread-1 (]: SQL status: SELECT 8473 in 0.974 seconds
[0m15:57:06.924446 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:57:06.924754 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m15:57:06.941483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m15:57:06.943853 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:57:06.944117 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m15:57:06.960898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m15:57:06.971454 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m15:57:06.971749 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:57:06.971950 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m15:57:06.989808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m15:57:06.993842 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m15:57:06.996661 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m15:57:06.996901 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m15:57:07.023100 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.026 seconds
[0m15:57:07.027103 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m15:57:07.029402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afdd9c60-8564-46e6-8a13-81284808174e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59ADC47D0>]}
[0m15:57:07.029892 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 8473[0m in 1.12s]
[0m15:57:07.030994 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m15:57:07.035369 [debug] [MainThread]: On master: COMMIT
[0m15:57:07.035689 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:07.035891 [debug] [MainThread]: On master: COMMIT
[0m15:57:07.036068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:07.159639 [debug] [MainThread]: SQL status: COMMIT in 0.123 seconds
[0m15:57:07.160335 [debug] [MainThread]: On master: Close
[0m15:57:07.161156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:07.161707 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m15:57:07.162168 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m15:57:07.162423 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m15:57:07.162738 [info ] [MainThread]: 
[0m15:57:07.163403 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m15:57:07.164461 [debug] [MainThread]: Command end result
[0m15:57:07.181409 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m15:57:07.183860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m15:57:07.189585 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m15:57:07.189970 [info ] [MainThread]: 
[0m15:57:07.190899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:07.191827 [info ] [MainThread]: 
[0m15:57:07.192948 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:57:07.194617 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:07.194442 after 2.76 seconds
[0m15:57:07.195028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A84D860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E594F540F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E598F21270>]}
[0m15:57:07.195395 [debug] [MainThread]: Flushing usage events
[0m15:57:07.848191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:10.802677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8189FD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F816534190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81AB73C50>]}


============================== 16:02:10.807659 | 44948887-919c-4cf0-83b0-346484b1cb08 ==============================
[0m16:02:10.807659 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:02:10.808949 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profile essenam', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m16:02:10.942495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44948887-919c-4cf0-83b0-346484b1cb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818E91F30>]}
[0m16:02:10.984669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44948887-919c-4cf0-83b0-346484b1cb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F819A1FDF0>]}
[0m16:02:10.986056 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:02:11.141371 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m16:02:11.251000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:11.251465 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m16:02:11.420016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44948887-919c-4cf0-83b0-346484b1cb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81B408150>]}
[0m16:02:11.503321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:02:11.505261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:02:11.534758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44948887-919c-4cf0-83b0-346484b1cb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81AB87020>]}
[0m16:02:11.535175 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:02:11.535814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44948887-919c-4cf0-83b0-346484b1cb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81B5CE190>]}
[0m16:02:11.537128 [info ] [MainThread]: 
[0m16:02:11.537637 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m16:02:11.538116 [info ] [MainThread]: 
[0m16:02:11.538614 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:11.539464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m16:02:11.581433 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m16:02:11.581926 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m16:02:11.582184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:11.716531 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.134 seconds
[0m16:02:11.719670 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m16:02:11.723338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m16:02:11.728572 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m16:02:11.728859 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m16:02:11.729066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:11.864577 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.135 seconds
[0m16:02:11.867172 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m16:02:11.881747 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m16:02:11.886664 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:11.887061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:02:11.887340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:12.030366 [debug] [MainThread]: SQL status: SELECT 0 in 0.143 seconds
[0m16:02:12.033815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44948887-919c-4cf0-83b0-346484b1cb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81B9706D0>]}
[0m16:02:12.034720 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:12.050385 [debug] [MainThread]: On master: COMMIT
[0m16:02:12.051537 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:12.052307 [debug] [MainThread]: On master: COMMIT
[0m16:02:12.083833 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m16:02:12.084413 [debug] [MainThread]: On master: Close
[0m16:02:12.094052 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m16:02:12.094535 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m16:02:12.095375 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m16:02:12.095660 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m16:02:12.100353 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m16:02:12.101304 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m16:02:12.131447 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m16:02:12.132436 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:02:12.132748 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    split_part(log, ' ', 1) as ip,

    -- timestamp
    to_timestamp(
        substring(log from '\\[(.*?)\\]'),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- requête complète : "GET /page HTTP/1.1"
    substring(log from '"([^"]+)"') as request,

    -- méthode HTTP
    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    -- page
    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    -- status code
    split_part(log, ' ', 9)::int as status_code,

    -- referer = 2e chaîne entre guillemets
    split_part(log, '"', 4) as referer,

    -- user agent = 3e chaîne entre guillemets
    split_part(log, '"', 6) as user_agent

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m16:02:12.132992 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:13.816647 [debug] [Thread-1 (]: SQL status: SELECT 8473 in 1.684 seconds
[0m16:02:13.824796 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:02:13.825179 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m16:02:13.841646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m16:02:13.845034 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:02:13.845501 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m16:02:13.862371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m16:02:13.873876 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:02:13.874247 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:02:13.874493 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:02:13.890611 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m16:02:13.896215 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m16:02:13.899883 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:02:13.900237 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m16:02:13.921116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m16:02:13.925358 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m16:02:13.927697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44948887-919c-4cf0-83b0-346484b1cb08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81BA307D0>]}
[0m16:02:13.928322 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 8473[0m in 1.83s]
[0m16:02:13.929263 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m16:02:13.932552 [debug] [MainThread]: On master: COMMIT
[0m16:02:13.932854 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:13.933069 [debug] [MainThread]: On master: COMMIT
[0m16:02:13.933262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:14.065299 [debug] [MainThread]: SQL status: COMMIT in 0.132 seconds
[0m16:02:14.065667 [debug] [MainThread]: On master: Close
[0m16:02:14.066076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:14.066287 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m16:02:14.066453 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m16:02:14.066608 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m16:02:14.066815 [info ] [MainThread]: 
[0m16:02:14.067504 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m16:02:14.068314 [debug] [MainThread]: Command end result
[0m16:02:14.082320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:02:14.084512 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:02:14.091401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m16:02:14.092184 [info ] [MainThread]: 
[0m16:02:14.093046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:14.093609 [info ] [MainThread]: 
[0m16:02:14.094200 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:02:14.095425 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:14.095301 after 3.43 seconds
[0m16:02:14.095727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81B4C1860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F815BB40F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F819B91270>]}
[0m16:02:14.096001 [debug] [MainThread]: Flushing usage events
[0m16:02:14.764871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:36.250949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015647D0D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015645844190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015649E83C50>]}


============================== 16:07:36.254712 | 46a8d9a2-1840-44a9-9ef8-32d28f1b1295 ==============================
[0m16:07:36.254712 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:07:36.255528 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m16:07:36.378504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a8d9a2-1840-44a9-9ef8-32d28f1b1295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156481A1F30>]}
[0m16:07:36.420312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a8d9a2-1840-44a9-9ef8-32d28f1b1295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015648D2FDF0>]}
[0m16:07:36.421686 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:07:36.563213 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m16:07:36.677263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:36.677700 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m16:07:36.861617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a8d9a2-1840-44a9-9ef8-32d28f1b1295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564A724150>]}
[0m16:07:36.942626 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:07:36.944472 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:07:36.967718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a8d9a2-1840-44a9-9ef8-32d28f1b1295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015649E97020>]}
[0m16:07:36.968118 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:07:36.968737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a8d9a2-1840-44a9-9ef8-32d28f1b1295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564A8E6190>]}
[0m16:07:36.970323 [info ] [MainThread]: 
[0m16:07:36.971029 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m16:07:36.971529 [info ] [MainThread]: 
[0m16:07:36.972104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:36.972925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m16:07:37.020108 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m16:07:37.020639 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m16:07:37.020951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:37.164958 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.144 seconds
[0m16:07:37.167956 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m16:07:37.171411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m16:07:37.176291 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m16:07:37.176562 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m16:07:37.176805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:37.335651 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.159 seconds
[0m16:07:37.337063 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m16:07:37.352402 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m16:07:37.361246 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:37.361764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:07:37.362134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:37.505899 [debug] [MainThread]: SQL status: SELECT 0 in 0.144 seconds
[0m16:07:37.507366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a8d9a2-1840-44a9-9ef8-32d28f1b1295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564AC906D0>]}
[0m16:07:37.507868 [debug] [MainThread]: On master: ROLLBACK
[0m16:07:37.526108 [debug] [MainThread]: On master: COMMIT
[0m16:07:37.526627 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:37.526893 [debug] [MainThread]: On master: COMMIT
[0m16:07:37.555871 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m16:07:37.556734 [debug] [MainThread]: On master: Close
[0m16:07:37.566095 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m16:07:37.566536 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m16:07:37.567572 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m16:07:37.568494 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m16:07:37.574202 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m16:07:37.575279 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m16:07:37.603058 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m16:07:37.604804 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:07:37.605369 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    split_part(log, ' ', 1) as ip,

    -- timestamp FIXÉ
    to_timestamp(
        trim(substring(log from '\\[(.*?)\\]')),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    substring(log from '"([^"]+)"') as request,

    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    split_part(log, ' ', 9)::int as status_code,

    split_part(log, '"', 4) as referer,

    split_part(log, '"', 6) as user_agent

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m16:07:37.605772 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:07:39.326530 [debug] [Thread-1 (]: SQL status: SELECT 8473 in 1.720 seconds
[0m16:07:39.335176 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:07:39.335450 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m16:07:39.353289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m16:07:39.355620 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:07:39.355880 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m16:07:39.372989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m16:07:39.383661 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:07:39.384019 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:07:39.384289 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:07:39.400051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m16:07:39.405354 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m16:07:39.408264 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:07:39.408525 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m16:07:39.431227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m16:07:39.433904 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m16:07:39.436258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a8d9a2-1840-44a9-9ef8-32d28f1b1295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564AD507D0>]}
[0m16:07:39.436791 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 8473[0m in 1.87s]
[0m16:07:39.437896 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m16:07:39.441325 [debug] [MainThread]: On master: COMMIT
[0m16:07:39.441594 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:39.441805 [debug] [MainThread]: On master: COMMIT
[0m16:07:39.441987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:39.589830 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m16:07:39.590205 [debug] [MainThread]: On master: Close
[0m16:07:39.590608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:39.590847 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m16:07:39.591038 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m16:07:39.591220 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m16:07:39.591481 [info ] [MainThread]: 
[0m16:07:39.592298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m16:07:39.593399 [debug] [MainThread]: Command end result
[0m16:07:39.607004 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:07:39.609074 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:07:39.613397 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m16:07:39.613698 [info ] [MainThread]: 
[0m16:07:39.614303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:39.614977 [info ] [MainThread]: 
[0m16:07:39.615494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:07:39.616447 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:39.616338 after 3.49 seconds
[0m16:07:39.616887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564A801860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015644EC40F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015648EA1270>]}
[0m16:07:39.617222 [debug] [MainThread]: Flushing usage events
[0m16:07:40.275982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:16.769189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD2B6D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD06B4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD4CE3C50>]}


============================== 16:10:16.773097 | 7a9f40b3-3163-46c7-a529-17318a1700c0 ==============================
[0m16:10:16.773097 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:10:16.773958 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'invocation_command': 'dbt run --profile essenam', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m16:10:16.902714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a9f40b3-3163-46c7-a529-17318a1700c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD3001F30>]}
[0m16:10:16.946658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a9f40b3-3163-46c7-a529-17318a1700c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD3B8FDF0>]}
[0m16:10:16.947918 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:10:17.084653 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m16:10:17.187859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:10:17.188376 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m16:10:17.360094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a9f40b3-3163-46c7-a529-17318a1700c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD54F4150>]}
[0m16:10:17.444628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:10:17.446674 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:10:17.466270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a9f40b3-3163-46c7-a529-17318a1700c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD4CF7020>]}
[0m16:10:17.466681 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:10:17.467348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a9f40b3-3163-46c7-a529-17318a1700c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD56BA190>]}
[0m16:10:17.468937 [info ] [MainThread]: 
[0m16:10:17.469723 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m16:10:17.470280 [info ] [MainThread]: 
[0m16:10:17.471010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:17.472135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m16:10:17.524976 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m16:10:17.525321 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m16:10:17.525549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:17.655370 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.130 seconds
[0m16:10:17.657153 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m16:10:17.659305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m16:10:17.663495 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m16:10:17.663804 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m16:10:17.664043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:17.797534 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.133 seconds
[0m16:10:17.800846 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m16:10:17.818549 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m16:10:17.824824 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:17.825298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:10:17.825653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:17.956605 [debug] [MainThread]: SQL status: SELECT 0 in 0.131 seconds
[0m16:10:17.959263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a9f40b3-3163-46c7-a529-17318a1700c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD5A606D0>]}
[0m16:10:17.960054 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:17.979543 [debug] [MainThread]: On master: COMMIT
[0m16:10:17.980832 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:17.981597 [debug] [MainThread]: On master: COMMIT
[0m16:10:18.010975 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m16:10:18.012564 [debug] [MainThread]: On master: Close
[0m16:10:18.028654 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m16:10:18.029143 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m16:10:18.030012 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m16:10:18.030310 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m16:10:18.035610 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m16:10:18.037062 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m16:10:18.067123 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m16:10:18.067980 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:10:18.068396 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    split_part(log, ' ', 1) as ip,

    -- timestamp ROBUSTE
    to_timestamp(
        replace(
            substring(log from '\\[(.*?)\\]'),
            ' ',
            ''
        ),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    substring(log from '"([^"]+)"') as request,

    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    split_part(log, ' ', 9)::int as status_code,

    split_part(log, '"', 4) as referer,

    split_part(log, '"', 6) as user_agent

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m16:10:18.068726 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:19.789393 [debug] [Thread-1 (]: SQL status: SELECT 8473 in 1.720 seconds
[0m16:10:19.799172 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:10:19.799447 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m16:10:19.815566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m16:10:19.819298 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:10:19.819673 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m16:10:19.835339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m16:10:19.846414 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:10:19.846688 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:10:19.846901 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:10:19.863240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m16:10:19.869554 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m16:10:19.875674 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:10:19.876108 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m16:10:19.899740 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.023 seconds
[0m16:10:19.903572 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m16:10:19.905918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f40b3-3163-46c7-a529-17318a1700c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD5B207D0>]}
[0m16:10:19.906425 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 8473[0m in 1.87s]
[0m16:10:19.907474 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m16:10:19.910969 [debug] [MainThread]: On master: COMMIT
[0m16:10:19.911237 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:19.911447 [debug] [MainThread]: On master: COMMIT
[0m16:10:19.911640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:20.043865 [debug] [MainThread]: SQL status: COMMIT in 0.132 seconds
[0m16:10:20.044938 [debug] [MainThread]: On master: Close
[0m16:10:20.046059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:20.046686 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m16:10:20.047162 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m16:10:20.047643 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m16:10:20.048137 [info ] [MainThread]: 
[0m16:10:20.049396 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m16:10:20.051612 [debug] [MainThread]: Command end result
[0m16:10:20.066291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:10:20.068409 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:10:20.072466 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m16:10:20.072791 [info ] [MainThread]: 
[0m16:10:20.073479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:20.074211 [info ] [MainThread]: 
[0m16:10:20.074885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:10:20.075847 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:20.075755 after 3.43 seconds
[0m16:10:20.076093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD55D1860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCFD440F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCD3D01270>]}
[0m16:10:20.076375 [debug] [MainThread]: Flushing usage events
[0m16:10:20.677828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:58.613200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A72D8D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A708D4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A73F33C50>]}


============================== 16:31:58.616597 | 2d9317f0-6de3-42ae-b82a-8df8b45cc944 ==============================
[0m16:31:58.616597 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:31:58.617498 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m16:31:58.747996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d9317f0-6de3-42ae-b82a-8df8b45cc944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A73221F30>]}
[0m16:31:58.789313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d9317f0-6de3-42ae-b82a-8df8b45cc944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A73DAFDF0>]}
[0m16:31:58.790586 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:31:58.942969 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m16:31:59.072537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:59.072991 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m16:31:59.272821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d9317f0-6de3-42ae-b82a-8df8b45cc944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A75794150>]}
[0m16:31:59.355539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:31:59.357333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:31:59.379375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d9317f0-6de3-42ae-b82a-8df8b45cc944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A73F47020>]}
[0m16:31:59.379798 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:31:59.380558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9317f0-6de3-42ae-b82a-8df8b45cc944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A75956190>]}
[0m16:31:59.381918 [info ] [MainThread]: 
[0m16:31:59.382574 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m16:31:59.383091 [info ] [MainThread]: 
[0m16:31:59.383771 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:59.384800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m16:31:59.430192 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m16:31:59.430495 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m16:31:59.430691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:59.638929 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.208 seconds
[0m16:31:59.640135 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m16:31:59.642255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m16:31:59.646780 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m16:31:59.647043 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m16:31:59.647266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:59.946278 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.299 seconds
[0m16:31:59.949269 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m16:31:59.974272 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m16:31:59.982096 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:59.982561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:31:59.982987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:00.255252 [debug] [MainThread]: SQL status: SELECT 0 in 0.272 seconds
[0m16:32:00.257534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d9317f0-6de3-42ae-b82a-8df8b45cc944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A75D006D0>]}
[0m16:32:00.258398 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:00.286143 [debug] [MainThread]: On master: COMMIT
[0m16:32:00.287196 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:00.288361 [debug] [MainThread]: On master: COMMIT
[0m16:32:00.351593 [debug] [MainThread]: SQL status: COMMIT in 0.062 seconds
[0m16:32:00.352759 [debug] [MainThread]: On master: Close
[0m16:32:00.362903 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m16:32:00.363350 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m16:32:00.364226 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m16:32:00.364657 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m16:32:00.369846 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m16:32:00.370664 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m16:32:00.399411 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m16:32:00.400296 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:32:00.400623 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select
        log
    from "wintershop_student"."wintershop_prod"."bronze"

),

parsed as (

    select
        -- IP
        split_part(log, ' ', 1) as ip,

        -- TIMESTAMP (CORRECT)
        to_timestamp(
            regexp_replace(
                regexp_extract(log, '\\[(.*?)\\]', 1),
                ' ',
                ''
            ),
            'DD/Mon/YYYY:HH24:MI:SS'
        ) as event_ts,

        -- FULL REQUEST
        regexp_extract(log, '"(GET|POST|PUT|DELETE) ([^"]+) HTTP/([0-9.]+)"', 0) as request,

        -- METHOD
        regexp_extract(log, '"(GET|POST|PUT|DELETE)', 1) as http_method,

        -- PAGE
        regexp_extract(log, '"(?:GET|POST|PUT|DELETE) ([^ ]+)', 1) as page,

        -- STATUS CODE
        regexp_extract(log, '" ([0-9]{3}) ', 1)::int as status_code,

        -- REFERER (URL BRUTE)
        regexp_extract(log, '"(http[^"]*)"', 1) as referer,

        -- USER AGENT
        regexp_extract(log, '"([^"]*)"$', 1) as user_agent

    from source
)

select * from parsed;
  );
  
[0m16:32:00.400875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:00.599384 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 57: select * from parsed;
                             ^

[0m16:32:00.599846 [debug] [Thread-1 (]: On model.wintershop.stg_logs: ROLLBACK
[0m16:32:00.627424 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m16:32:00.634868 [debug] [Thread-1 (]: Database Error in model stg_logs (models\silver\stg_logs.sql)
  syntax error at or near ";"
  LINE 57: select * from parsed;
                               ^
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m16:32:00.636806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d9317f0-6de3-42ae-b82a-8df8b45cc944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A75DC07D0>]}
[0m16:32:00.637280 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wintershop_essenam.stg_logs .............. [[31mERROR[0m in 0.27s]
[0m16:32:00.638325 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m16:32:00.638829 [debug] [Thread-27 ]: Marking all children of 'model.wintershop.stg_logs' to be skipped because of status 'error'.  Reason: Database Error in model stg_logs (models\silver\stg_logs.sql)
  syntax error at or near ";"
  LINE 57: select * from parsed;
                               ^
  compiled code at target\run\wintershop\models\silver\stg_logs.sql.
[0m16:32:00.642765 [debug] [MainThread]: On master: COMMIT
[0m16:32:00.643162 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:00.643484 [debug] [MainThread]: On master: COMMIT
[0m16:32:00.643786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:00.862906 [debug] [MainThread]: SQL status: COMMIT in 0.219 seconds
[0m16:32:00.863649 [debug] [MainThread]: On master: Close
[0m16:32:00.864460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:00.864943 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m16:32:00.865358 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m16:32:00.865748 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m16:32:00.866245 [info ] [MainThread]: 
[0m16:32:00.867610 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m16:32:00.869229 [debug] [MainThread]: Command end result
[0m16:32:00.882263 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:32:00.884970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:32:00.891746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m16:32:00.892081 [info ] [MainThread]: 
[0m16:32:00.892853 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:32:00.893381 [info ] [MainThread]: 
[0m16:32:00.893908 [error] [MainThread]: [31mFailure in model stg_logs (models\silver\stg_logs.sql)[0m
[0m16:32:00.894571 [error] [MainThread]:   Database Error in model stg_logs (models\silver\stg_logs.sql)
  syntax error at or near ";"
  LINE 57: select * from parsed;
                               ^
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m16:32:00.895134 [info ] [MainThread]: 
[0m16:32:00.895665 [info ] [MainThread]:   compiled code at target\compiled\wintershop\models\silver\stg_logs.sql
[0m16:32:00.896112 [info ] [MainThread]: 
[0m16:32:00.896574 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:32:00.897487 [debug] [MainThread]: Command `dbt run` failed at 16:32:00.897381 after 2.46 seconds
[0m16:32:00.897831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A75872150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A7577CC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A7577CB90>]}
[0m16:32:00.898165 [debug] [MainThread]: Flushing usage events
[0m16:32:01.698093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:11.948093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33235D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32FE94190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D333503C50>]}


============================== 16:34:11.951503 | 03f12b8e-e28a-475b-a714-b241601e13da ==============================
[0m16:34:11.951503 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:34:11.952246 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m16:34:12.073583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03f12b8e-e28a-475b-a714-b241601e13da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3327F1F30>]}
[0m16:34:12.117893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03f12b8e-e28a-475b-a714-b241601e13da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33337FDF0>]}
[0m16:34:12.119308 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:34:12.252304 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m16:34:12.361578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:12.362049 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m16:34:12.531235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03f12b8e-e28a-475b-a714-b241601e13da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D334D18150>]}
[0m16:34:12.613950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:34:12.615780 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:34:12.635086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03f12b8e-e28a-475b-a714-b241601e13da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D333517020>]}
[0m16:34:12.635497 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:34:12.636154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f12b8e-e28a-475b-a714-b241601e13da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D334EDA190>]}
[0m16:34:12.638732 [info ] [MainThread]: 
[0m16:34:12.639789 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m16:34:12.640695 [info ] [MainThread]: 
[0m16:34:12.641690 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:12.642700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m16:34:12.689068 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m16:34:12.689420 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m16:34:12.689617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:12.873311 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.183 seconds
[0m16:34:12.876723 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m16:34:12.880053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m16:34:12.885524 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m16:34:12.885839 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m16:34:12.886072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:13.091143 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.205 seconds
[0m16:34:13.092096 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m16:34:13.108591 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m16:34:13.112044 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:13.112394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:34:13.112710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:13.297013 [debug] [MainThread]: SQL status: SELECT 0 in 0.184 seconds
[0m16:34:13.299280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f12b8e-e28a-475b-a714-b241601e13da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3352806D0>]}
[0m16:34:13.300220 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:13.318698 [debug] [MainThread]: On master: COMMIT
[0m16:34:13.319652 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:13.320298 [debug] [MainThread]: On master: COMMIT
[0m16:34:13.361730 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m16:34:13.362734 [debug] [MainThread]: On master: Close
[0m16:34:13.374225 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m16:34:13.374658 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m16:34:13.375474 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m16:34:13.375766 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m16:34:13.380763 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m16:34:13.381542 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m16:34:13.412335 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m16:34:13.413965 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:34:13.414415 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select
        log
    from "wintershop_student"."wintershop_prod"."bronze"

),

parsed as (

    select
        -- IP
        split_part(log, ' ', 1) as ip,

        -- TIMESTAMP (CORRECT)
        to_timestamp(
            regexp_replace(
                regexp_extract(log, '\\[(.*?)\\]', 1),
                ' ',
                ''
            ),
            'DD/Mon/YYYY:HH24:MI:SS'
        ) as event_ts,

        -- FULL REQUEST
        regexp_extract(log, '"(GET|POST|PUT|DELETE) ([^"]+) HTTP/([0-9.]+)"', 0) as request,

        -- METHOD
        regexp_extract(log, '"(GET|POST|PUT|DELETE)', 1) as http_method,

        -- PAGE
        regexp_extract(log, '"(?:GET|POST|PUT|DELETE) ([^ ]+)', 1) as page,

        -- STATUS CODE
        regexp_extract(log, '" ([0-9]{3}) ', 1)::int as status_code,

        -- REFERER (URL BRUTE)
        regexp_extract(log, '"(http[^"]*)"', 1) as referer,

        -- USER AGENT
        regexp_extract(log, '"([^"]*)"$', 1) as user_agent

    from source
)

select * from parsed
  );
  
[0m16:34:13.414679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:13.554925 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function regexp_extract(text, unknown, integer) does not exist
LINE 29:                 regexp_extract(log, '\\[(.*?)\\]', 1),
                         ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m16:34:13.555643 [debug] [Thread-1 (]: On model.wintershop.stg_logs: ROLLBACK
[0m16:34:13.572395 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m16:34:13.579208 [debug] [Thread-1 (]: Database Error in model stg_logs (models\silver\stg_logs.sql)
  function regexp_extract(text, unknown, integer) does not exist
  LINE 29:                 regexp_extract(log, '\\[(.*?)\\]', 1),
                           ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m16:34:13.580948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03f12b8e-e28a-475b-a714-b241601e13da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D33533C7D0>]}
[0m16:34:13.581415 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wintershop_essenam.stg_logs .............. [[31mERROR[0m in 0.20s]
[0m16:34:13.582434 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m16:34:13.582891 [debug] [Thread-27 ]: Marking all children of 'model.wintershop.stg_logs' to be skipped because of status 'error'.  Reason: Database Error in model stg_logs (models\silver\stg_logs.sql)
  function regexp_extract(text, unknown, integer) does not exist
  LINE 29:                 regexp_extract(log, '\\[(.*?)\\]', 1),
                           ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\wintershop\models\silver\stg_logs.sql.
[0m16:34:13.586687 [debug] [MainThread]: On master: COMMIT
[0m16:34:13.586926 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:13.587115 [debug] [MainThread]: On master: COMMIT
[0m16:34:13.587275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:13.702931 [debug] [MainThread]: SQL status: COMMIT in 0.116 seconds
[0m16:34:13.703422 [debug] [MainThread]: On master: Close
[0m16:34:13.703962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:13.704293 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m16:34:13.704594 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m16:34:13.704860 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m16:34:13.705188 [info ] [MainThread]: 
[0m16:34:13.706275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m16:34:13.707719 [debug] [MainThread]: Command end result
[0m16:34:13.721581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:34:13.723408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:34:13.728625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m16:34:13.728967 [info ] [MainThread]: 
[0m16:34:13.729695 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:34:13.730377 [info ] [MainThread]: 
[0m16:34:13.731057 [error] [MainThread]: [31mFailure in model stg_logs (models\silver\stg_logs.sql)[0m
[0m16:34:13.731799 [error] [MainThread]:   Database Error in model stg_logs (models\silver\stg_logs.sql)
  function regexp_extract(text, unknown, integer) does not exist
  LINE 29:                 regexp_extract(log, '\\[(.*?)\\]', 1),
                           ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m16:34:13.732359 [info ] [MainThread]: 
[0m16:34:13.733198 [info ] [MainThread]:   compiled code at target\compiled\wintershop\models\silver\stg_logs.sql
[0m16:34:13.733784 [info ] [MainThread]: 
[0m16:34:13.734124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:34:13.734929 [debug] [MainThread]: Command `dbt run` failed at 16:34:13.734833 after 1.92 seconds
[0m16:34:13.735205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D334DF2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D334CFCC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D334CFCB90>]}
[0m16:34:13.735472 [debug] [MainThread]: Flushing usage events
[0m16:34:14.414671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:10.482822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AA9CD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A8514190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202ABB73C50>]}


============================== 16:35:10.488615 | 2e47e7d3-84bf-4563-b2ae-9b405ceb65e1 ==============================
[0m16:35:10.488615 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:35:10.490464 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m16:35:10.618991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e47e7d3-84bf-4563-b2ae-9b405ceb65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AAE61F30>]}
[0m16:35:10.662932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e47e7d3-84bf-4563-b2ae-9b405ceb65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AB9EFDF0>]}
[0m16:35:10.664285 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:35:10.796426 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m16:35:10.915668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:10.916274 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m16:35:11.091719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e47e7d3-84bf-4563-b2ae-9b405ceb65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AD354150>]}
[0m16:35:11.174620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:35:11.176728 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:35:11.197170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e47e7d3-84bf-4563-b2ae-9b405ceb65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202ABB87020>]}
[0m16:35:11.197600 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:35:11.198209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e47e7d3-84bf-4563-b2ae-9b405ceb65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AD516190>]}
[0m16:35:11.199565 [info ] [MainThread]: 
[0m16:35:11.200126 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m16:35:11.200679 [info ] [MainThread]: 
[0m16:35:11.201200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:11.201984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m16:35:11.244336 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m16:35:11.244651 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m16:35:11.244850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:11.393335 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.148 seconds
[0m16:35:11.396122 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m16:35:11.398905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m16:35:11.403146 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m16:35:11.403417 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m16:35:11.403656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:11.556904 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.153 seconds
[0m16:35:11.558542 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m16:35:11.574228 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m16:35:11.583374 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:11.584031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:35:11.584547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:11.726426 [debug] [MainThread]: SQL status: SELECT 0 in 0.142 seconds
[0m16:35:11.730128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e47e7d3-84bf-4563-b2ae-9b405ceb65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AD8C06D0>]}
[0m16:35:11.731111 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:11.746172 [debug] [MainThread]: On master: COMMIT
[0m16:35:11.747243 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:11.747962 [debug] [MainThread]: On master: COMMIT
[0m16:35:11.779354 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m16:35:11.780393 [debug] [MainThread]: On master: Close
[0m16:35:11.798858 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m16:35:11.799401 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m16:35:11.800023 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m16:35:11.800341 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m16:35:11.805457 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m16:35:11.806285 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m16:35:11.835015 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m16:35:11.835896 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:35:11.836221 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

with parsed as (

    select
        log,

        -- IP
        split_part(log, ' ', 1) as ip,

        -- TIMESTAMP (Apache, robuste)
        to_timestamp(
            replace(
                substring(log from '\\[(.*?)\\]'),
                ' ',
                ''
            ),
            'DD/Mon/YYYY:HH24:MI:SS'
        ) as event_ts,

        -- requête complète
        substring(log from '"([^"]+)"') as request,

        -- méthode HTTP
        split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

        -- page
        split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

        -- status code
        split_part(log, ' ', 9)::int as status_code,

        -- referer (2e champ entre guillemets)
        split_part(log, '"', 4) as referer,

        -- user agent (3e champ entre guillemets)
        split_part(log, '"', 6) as user_agent

    from "wintershop_student"."wintershop_prod"."bronze"

)

select * from parsed
  );
  
[0m16:35:11.836478 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:13.572470 [debug] [Thread-1 (]: SQL status: SELECT 8473 in 1.736 seconds
[0m16:35:13.581771 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:35:13.582019 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m16:35:13.598529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m16:35:13.601184 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:35:13.601470 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m16:35:13.618171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m16:35:13.634905 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:35:13.635229 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:35:13.635443 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:35:13.662062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m16:35:13.666431 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m16:35:13.669770 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:35:13.670089 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m16:35:13.691900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m16:35:13.694458 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m16:35:13.696683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e47e7d3-84bf-4563-b2ae-9b405ceb65e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AD9807D0>]}
[0m16:35:13.697280 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 8473[0m in 1.90s]
[0m16:35:13.698098 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m16:35:13.701503 [debug] [MainThread]: On master: COMMIT
[0m16:35:13.701867 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:13.702108 [debug] [MainThread]: On master: COMMIT
[0m16:35:13.702311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:13.837295 [debug] [MainThread]: SQL status: COMMIT in 0.135 seconds
[0m16:35:13.838246 [debug] [MainThread]: On master: Close
[0m16:35:13.839252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:13.839811 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m16:35:13.840264 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m16:35:13.840763 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m16:35:13.841344 [info ] [MainThread]: 
[0m16:35:13.842589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m16:35:13.844219 [debug] [MainThread]: Command end result
[0m16:35:13.856867 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:35:13.858866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:35:13.863271 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m16:35:13.863562 [info ] [MainThread]: 
[0m16:35:13.864264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:13.864841 [info ] [MainThread]: 
[0m16:35:13.865497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:35:13.866443 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:13.866344 after 3.51 seconds
[0m16:35:13.866711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202AD40D860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202A7B940F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202ABB61270>]}
[0m16:35:13.866967 [debug] [MainThread]: Flushing usage events
[0m16:35:14.485525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:51.224341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962AE2D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019628974190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962CFA3C50>]}


============================== 16:37:51.228265 | a4a794ad-bd6e-424e-a2da-d5272f2f6a12 ==============================
[0m16:37:51.228265 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:37:51.229056 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profile essenam', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m16:37:51.353631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a794ad-bd6e-424e-a2da-d5272f2f6a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962B2C1F30>]}
[0m16:37:51.396880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a794ad-bd6e-424e-a2da-d5272f2f6a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962BE4FDF0>]}
[0m16:37:51.398287 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:37:51.529772 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m16:37:51.630906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:37:51.631352 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m16:37:51.795829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4a794ad-bd6e-424e-a2da-d5272f2f6a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962D838150>]}
[0m16:37:51.896661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:37:51.898638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:37:51.920093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4a794ad-bd6e-424e-a2da-d5272f2f6a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962CFB7020>]}
[0m16:37:51.920525 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:37:51.921079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a794ad-bd6e-424e-a2da-d5272f2f6a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962D9FE190>]}
[0m16:37:51.922682 [info ] [MainThread]: 
[0m16:37:51.923372 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m16:37:51.923867 [info ] [MainThread]: 
[0m16:37:51.924369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:51.925327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m16:37:51.968347 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m16:37:51.968644 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m16:37:51.968836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:52.124149 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.155 seconds
[0m16:37:52.127000 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m16:37:52.130048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m16:37:52.134733 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m16:37:52.134991 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m16:37:52.135443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:52.294901 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.159 seconds
[0m16:37:52.296951 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m16:37:52.312859 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m16:37:52.318130 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:52.318561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:37:52.318870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:52.486439 [debug] [MainThread]: SQL status: SELECT 0 in 0.167 seconds
[0m16:37:52.487738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a794ad-bd6e-424e-a2da-d5272f2f6a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962DDA06D0>]}
[0m16:37:52.488205 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:52.504799 [debug] [MainThread]: On master: COMMIT
[0m16:37:52.505600 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:52.506037 [debug] [MainThread]: On master: COMMIT
[0m16:37:52.535497 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m16:37:52.536210 [debug] [MainThread]: On master: Close
[0m16:37:52.545875 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m16:37:52.546358 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m16:37:52.547136 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m16:37:52.547436 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m16:37:52.552160 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m16:37:52.552956 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m16:37:52.583071 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m16:37:52.584049 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:37:52.584428 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    split_part(log, ' ', 1) as ip,

    -- TIMESTAMP (VERSION QUI MARCHE)
    to_timestamp(
        trim(
            replace(
                split_part(split_part(log, '[', 2), ']', 1),
                ' ',
                ''
            )
        ),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- requête complète
    substring(log from '"([^"]+)"') as request,

    -- méthode HTTP
    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    -- page
    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    -- status code
    split_part(log, ' ', 9)::int as status_code,

    -- referer
    split_part(log, '"', 4) as referer,

    -- user agent
    split_part(log, '"', 6) as user_agent

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m16:37:52.584701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:37:54.544105 [debug] [Thread-1 (]: SQL status: SELECT 8473 in 1.959 seconds
[0m16:37:54.550314 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:37:54.550695 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m16:37:54.570294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m16:37:54.572848 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:37:54.573411 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m16:37:54.592420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m16:37:54.602034 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:37:54.602329 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:37:54.602543 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m16:37:54.623174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m16:37:54.627580 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m16:37:54.630615 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m16:37:54.630878 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m16:37:54.661930 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m16:37:54.663980 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m16:37:54.666447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a794ad-bd6e-424e-a2da-d5272f2f6a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962DE607D0>]}
[0m16:37:54.667093 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 8473[0m in 2.12s]
[0m16:37:54.668515 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m16:37:54.672935 [debug] [MainThread]: On master: COMMIT
[0m16:37:54.673427 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:54.673830 [debug] [MainThread]: On master: COMMIT
[0m16:37:54.674346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:54.853330 [debug] [MainThread]: SQL status: COMMIT in 0.179 seconds
[0m16:37:54.853799 [debug] [MainThread]: On master: Close
[0m16:37:54.854358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:54.854691 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m16:37:54.855039 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m16:37:54.855336 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m16:37:54.855641 [info ] [MainThread]: 
[0m16:37:54.856403 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m16:37:54.857376 [debug] [MainThread]: Command end result
[0m16:37:54.874000 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m16:37:54.877739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m16:37:54.883770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m16:37:54.884169 [info ] [MainThread]: 
[0m16:37:54.885026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:54.885791 [info ] [MainThread]: 
[0m16:37:54.886636 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:37:54.888190 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:54.887924 after 3.80 seconds
[0m16:37:54.888891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962D8ED860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019627FF40F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962BFC1270>]}
[0m16:37:54.889581 [debug] [MainThread]: Flushing usage events
[0m16:37:55.593032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:36.564743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967690D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019674454190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019678A83C50>]}


============================== 21:46:36.571812 | 235c9f30-d83c-4258-8d61-8e539c7ff964 ==============================
[0m21:46:36.571812 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:46:36.572735 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m21:46:36.978813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '235c9f30-d83c-4258-8d61-8e539c7ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019676DA1F30>]}
[0m21:46:37.028730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '235c9f30-d83c-4258-8d61-8e539c7ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967792FDF0>]}
[0m21:46:37.030354 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:46:37.408713 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m21:46:38.660778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:38.661334 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m21:46:38.864910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '235c9f30-d83c-4258-8d61-8e539c7ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196792A4150>]}
[0m21:46:38.962681 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m21:46:38.994668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m21:46:39.065948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '235c9f30-d83c-4258-8d61-8e539c7ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019678A97020>]}
[0m21:46:39.066378 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m21:46:39.067074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '235c9f30-d83c-4258-8d61-8e539c7ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019679466190>]}
[0m21:46:39.068992 [info ] [MainThread]: 
[0m21:46:39.069502 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m21:46:39.069873 [info ] [MainThread]: 
[0m21:46:39.070409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:46:39.071676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m21:46:42.559164 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m21:46:42.562147 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m21:46:42.564514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:42.859647 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.295 seconds
[0m21:46:42.869428 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m21:46:42.880285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m21:46:42.918101 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m21:46:42.920974 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m21:46:42.924098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:43.134457 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.210 seconds
[0m21:46:43.143924 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m21:46:43.167016 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m21:46:43.195134 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:43.198316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:46:43.200966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:43.412543 [debug] [MainThread]: SQL status: SELECT 1 in 0.211 seconds
[0m21:46:43.421688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '235c9f30-d83c-4258-8d61-8e539c7ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196798106D0>]}
[0m21:46:43.425128 [debug] [MainThread]: On master: ROLLBACK
[0m21:46:43.448296 [debug] [MainThread]: On master: COMMIT
[0m21:46:43.451028 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:43.453166 [debug] [MainThread]: On master: COMMIT
[0m21:46:43.500474 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:46:43.503217 [debug] [MainThread]: On master: Close
[0m21:46:43.602051 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m21:46:43.606101 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m21:46:43.611106 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m21:46:43.613826 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m21:46:43.672771 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m21:46:43.680348 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m21:46:43.983961 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m21:46:43.992565 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m21:46:43.995794 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    split_part(log, ' ', 1) as ip,

    -- TIMESTAMP (VERSION QUI MARCHE)
    to_timestamp(
        trim(
            replace(
                split_part(split_part(log, '[', 2), ']', 1),
                ' ',
                ''
            )
        ),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- requête complète
    substring(log from '"([^"]+)"') as request,

    -- méthode HTTP
    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    -- page
    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    -- status code
    split_part(log, ' ', 9)::int as status_code,

    -- referer
    split_part(log, '"', 4) as referer,

    -- user agent
    split_part(log, '"', 6) as user_agent

from "wintershop_student"."wintershop_prod"."bronze"

-- page normalisée (sans slash final)
regexp_replace(lower(page), '/$', '') as page_clean,

-- host du referer (sans catégorisation)
split_part(
  regexp_replace(referer, '^https?://', ''),
  '/',
  1
) as referer_host,

-- détection technique des bots
(user_agent ilike '%bot%') as is_bot
  );
  
[0m21:46:43.998777 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:46:44.230257 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 53: regexp_replace(lower(page), '/$', '') as page_clean,
                             ^

[0m21:46:44.233278 [debug] [Thread-1 (]: On model.wintershop.stg_logs: ROLLBACK
[0m21:46:44.259621 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m21:46:45.211469 [debug] [Thread-1 (]: Database Error in model stg_logs (models\silver\stg_logs.sql)
  syntax error at or near "("
  LINE 53: regexp_replace(lower(page), '/$', '') as page_clean,
                               ^
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m21:46:45.231643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '235c9f30-d83c-4258-8d61-8e539c7ff964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196798DC890>]}
[0m21:46:45.237701 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model wintershop_essenam.stg_logs .............. [[31mERROR[0m in 1.60s]
[0m21:46:45.244262 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m21:46:45.248846 [debug] [Thread-27 ]: Marking all children of 'model.wintershop.stg_logs' to be skipped because of status 'error'.  Reason: Database Error in model stg_logs (models\silver\stg_logs.sql)
  syntax error at or near "("
  LINE 53: regexp_replace(lower(page), '/$', '') as page_clean,
                               ^
  compiled code at target\run\wintershop\models\silver\stg_logs.sql.
[0m21:46:45.279210 [debug] [MainThread]: On master: COMMIT
[0m21:46:45.287046 [debug] [MainThread]: Using postgres connection "master"
[0m21:46:45.291520 [debug] [MainThread]: On master: COMMIT
[0m21:46:45.295207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:45.479495 [debug] [MainThread]: SQL status: COMMIT in 0.184 seconds
[0m21:46:45.480798 [debug] [MainThread]: On master: Close
[0m21:46:45.481988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:45.482646 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m21:46:45.483130 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m21:46:45.483620 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m21:46:45.484153 [info ] [MainThread]: 
[0m21:46:45.485432 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.41 seconds (6.41s).
[0m21:46:45.487027 [debug] [MainThread]: Command end result
[0m21:46:45.509491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m21:46:45.512751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m21:46:45.535947 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m21:46:45.536336 [info ] [MainThread]: 
[0m21:46:45.537151 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:45.537892 [info ] [MainThread]: 
[0m21:46:45.539296 [error] [MainThread]: [31mFailure in model stg_logs (models\silver\stg_logs.sql)[0m
[0m21:46:45.540618 [error] [MainThread]:   Database Error in model stg_logs (models\silver\stg_logs.sql)
  syntax error at or near "("
  LINE 53: regexp_replace(lower(page), '/$', '') as page_clean,
                               ^
  compiled code at target\run\wintershop\models\silver\stg_logs.sql
[0m21:46:45.541626 [info ] [MainThread]: 
[0m21:46:45.542414 [info ] [MainThread]:   compiled code at target\compiled\wintershop\models\silver\stg_logs.sql
[0m21:46:45.543217 [info ] [MainThread]: 
[0m21:46:45.544036 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:46:45.545681 [debug] [MainThread]: Command `dbt run` failed at 21:46:45.545523 after 9.18 seconds
[0m21:46:45.546063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196793522B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196792B40F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196792B60D0>]}
[0m21:46:45.546438 [debug] [MainThread]: Flushing usage events
[0m21:46:46.265182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:49:32.738447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325F79D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325D2E4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023261913C50>]}


============================== 21:49:32.742497 | c0e0728e-5676-4f0b-b56e-4590be1df58c ==============================
[0m21:49:32.742497 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:49:32.743453 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m21:49:32.882685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e0728e-5676-4f0b-b56e-4590be1df58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002325FC31F30>]}
[0m21:49:32.926694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0e0728e-5676-4f0b-b56e-4590be1df58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232607BFDF0>]}
[0m21:49:32.928647 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:49:33.085139 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m21:49:33.204486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:49:33.204934 [debug] [MainThread]: Partial parsing: updated file: wintershop://models\silver\stg_logs.sql
[0m21:49:33.375718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0e0728e-5676-4f0b-b56e-4590be1df58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232621C8150>]}
[0m21:49:33.465783 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m21:49:33.467828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m21:49:33.497750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0e0728e-5676-4f0b-b56e-4590be1df58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023261927020>]}
[0m21:49:33.498108 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m21:49:33.498874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e0728e-5676-4f0b-b56e-4590be1df58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326238A190>]}
[0m21:49:33.500114 [info ] [MainThread]: 
[0m21:49:33.500794 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m21:49:33.501465 [info ] [MainThread]: 
[0m21:49:33.502265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:33.503276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m21:49:33.554583 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m21:49:33.554887 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m21:49:33.555084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:33.741010 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.186 seconds
[0m21:49:33.744229 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m21:49:33.747890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m21:49:33.755555 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m21:49:33.755959 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m21:49:33.756291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:33.936282 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.180 seconds
[0m21:49:33.939410 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m21:49:33.960939 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m21:49:33.968565 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:33.968946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:49:33.969408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:34.133468 [debug] [MainThread]: SQL status: SELECT 1 in 0.164 seconds
[0m21:49:34.136731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e0728e-5676-4f0b-b56e-4590be1df58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232627306D0>]}
[0m21:49:34.137853 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:34.158726 [debug] [MainThread]: On master: COMMIT
[0m21:49:34.160379 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:34.161379 [debug] [MainThread]: On master: COMMIT
[0m21:49:34.202536 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m21:49:34.203355 [debug] [MainThread]: On master: Close
[0m21:49:34.228362 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m21:49:34.229199 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m21:49:34.230584 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m21:49:34.231085 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m21:49:34.238329 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m21:49:34.239148 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m21:49:34.267546 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m21:49:34.268444 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m21:49:34.268796 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    split_part(log, ' ', 1) as ip,

    -- TIMESTAMP
    to_timestamp(
        trim(
            replace(
                split_part(split_part(log, '[', 2), ']', 1),
                ' ',
                ''
            )
        ),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- requête complète
    substring(log from '"([^"]+)"') as request,

    -- méthode HTTP
    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    -- page
    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    -- page normalisée (sans slash final)
    regexp_replace(
        lower(split_part(substring(log from '"([^"]+)"'), ' ', 2)),
        '/$',
        ''
    ) as page_clean,

    -- status code
    split_part(log, ' ', 9)::int as status_code,

    -- referer (URL complète)
    split_part(log, '"', 4) as referer,

    -- host du referer
    split_part(
        regexp_replace(split_part(log, '"', 4), '^https?://', ''),
        '/',
        1
    ) as referer_host,

    -- user agent
    split_part(log, '"', 6) as user_agent,

    -- détection bot (technique, pas métier)
    split_part(log, '"', 6) ilike '%bot%' as is_bot

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m21:49:34.269059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:10.022678 [debug] [Thread-1 (]: SQL status: SELECT 198833 in 35.753 seconds
[0m21:50:10.039189 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m21:50:10.039601 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m21:50:10.064286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m21:50:10.067261 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m21:50:10.067777 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m21:50:10.092511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m21:50:10.116590 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m21:50:10.116934 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m21:50:10.117157 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m21:50:10.140889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m21:50:10.151643 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m21:50:10.156964 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m21:50:10.157287 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m21:50:10.187111 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m21:50:10.192423 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m21:50:10.195491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e0728e-5676-4f0b-b56e-4590be1df58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232627F0890>]}
[0m21:50:10.196570 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 198833[0m in 35.96s]
[0m21:50:10.198164 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m21:50:10.203196 [debug] [MainThread]: On master: COMMIT
[0m21:50:10.203663 [debug] [MainThread]: Using postgres connection "master"
[0m21:50:10.204022 [debug] [MainThread]: On master: COMMIT
[0m21:50:10.204380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:50:10.387840 [debug] [MainThread]: SQL status: COMMIT in 0.183 seconds
[0m21:50:10.388686 [debug] [MainThread]: On master: Close
[0m21:50:10.389550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:10.390078 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m21:50:10.390502 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m21:50:10.390893 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m21:50:10.391388 [info ] [MainThread]: 
[0m21:50:10.392638 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.89 seconds (36.89s).
[0m21:50:10.394566 [debug] [MainThread]: Command end result
[0m21:50:10.412826 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m21:50:10.414908 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m21:50:10.419826 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m21:50:10.420179 [info ] [MainThread]: 
[0m21:50:10.421042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:10.421615 [info ] [MainThread]: 
[0m21:50:10.422249 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:50:10.423538 [debug] [MainThread]: Command `dbt run` succeeded at 21:50:10.423423 after 37.83 seconds
[0m21:50:10.423899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002326227D860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023262432530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232624328F0>]}
[0m21:50:10.424360 [debug] [MainThread]: Flushing usage events
[0m21:50:11.104324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:32.811320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB1C9D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABAF7E4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB3E13C50>]}


============================== 22:18:32.816153 | f2578385-09e2-4f61-a98b-5659497cb0b2 ==============================
[0m22:18:32.816153 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:18:32.817010 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'invocation_command': 'dbt compile --profile essenam', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:18:33.052988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2578385-09e2-4f61-a98b-5659497cb0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB2131F30>]}
[0m22:18:33.128929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2578385-09e2-4f61-a98b-5659497cb0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB2CBFDF0>]}
[0m22:18:33.131283 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:18:33.813008 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m22:18:34.109654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:18:34.110652 [debug] [MainThread]: Partial parsing: added file: wintershop://macros\log_parsing.sql
[0m22:18:34.246234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2578385-09e2-4f61-a98b-5659497cb0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB4659A50>]}
[0m22:18:34.500700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:18:34.507319 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:18:34.570571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2578385-09e2-4f61-a98b-5659497cb0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB4686B70>]}
[0m22:18:34.571620 [info ] [MainThread]: Found 1 model, 1 source, 467 macros
[0m22:18:34.572507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2578385-09e2-4f61-a98b-5659497cb0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB475FE70>]}
[0m22:18:34.575463 [info ] [MainThread]: 
[0m22:18:34.576465 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m22:18:34.577308 [info ] [MainThread]: 
[0m22:18:34.579684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:34.581535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m22:18:34.903825 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m22:18:34.904721 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m22:18:34.905383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:35.102186 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.197 seconds
[0m22:18:35.104726 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m22:18:35.125847 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m22:18:35.134384 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:35.135885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:18:35.137116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:35.332770 [debug] [MainThread]: SQL status: SELECT 1 in 0.196 seconds
[0m22:18:35.335881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2578385-09e2-4f61-a98b-5659497cb0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB4A60EF0>]}
[0m22:18:35.337141 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:35.364252 [debug] [MainThread]: On master: Close
[0m22:18:35.377938 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m22:18:35.379204 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m22:18:35.380196 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m22:18:35.394259 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m22:18:35.395906 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m22:18:35.396745 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m22:18:35.400220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:35.400842 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m22:18:35.401521 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m22:18:35.402966 [debug] [MainThread]: Command end result
[0m22:18:35.443227 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:18:35.450165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:18:35.464917 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m22:18:35.467855 [debug] [MainThread]: Command `dbt compile` succeeded at 22:18:35.467476 after 2.85 seconds
[0m22:18:35.468753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB2AE7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB4855440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABB48557B0>]}
[0m22:18:35.469676 [debug] [MainThread]: Flushing usage events
[0m22:18:36.589639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:55.294670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED756D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED50B4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED96E3C50>]}


============================== 22:23:55.299359 | e7c80062-33ef-47e6-9a7b-4ca465537b5b ==============================
[0m22:23:55.299359 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:23:55.300520 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:23:55.635569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7c80062-33ef-47e6-9a7b-4ca465537b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED7A01F30>]}
[0m22:23:55.688346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7c80062-33ef-47e6-9a7b-4ca465537b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED858FDF0>]}
[0m22:23:55.690050 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:23:56.040830 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m22:23:57.660791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:23:57.661173 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:23:57.661374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:23:57.684281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7c80062-33ef-47e6-9a7b-4ca465537b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED9F25950>]}
[0m22:23:57.732159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:23:57.749363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:23:57.779773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7c80062-33ef-47e6-9a7b-4ca465537b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED9E37980>]}
[0m22:23:57.780237 [info ] [MainThread]: Found 1 model, 1 source, 467 macros
[0m22:23:57.781693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c80062-33ef-47e6-9a7b-4ca465537b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED86E6970>]}
[0m22:23:57.783101 [info ] [MainThread]: 
[0m22:23:57.783763 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m22:23:57.784344 [info ] [MainThread]: 
[0m22:23:57.785015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:23:57.786172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m22:24:01.603763 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m22:24:01.604124 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m22:24:01.604384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:01.782794 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.178 seconds
[0m22:24:01.784437 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m22:24:01.786877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m22:24:01.790916 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m22:24:01.791249 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m22:24:01.791628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:01.968066 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.176 seconds
[0m22:24:01.969363 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m22:24:01.990026 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m22:24:01.994745 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:01.995180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:24:01.995542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:02.155263 [debug] [MainThread]: SQL status: SELECT 1 in 0.160 seconds
[0m22:24:02.156253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c80062-33ef-47e6-9a7b-4ca465537b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA331640>]}
[0m22:24:02.156617 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:02.177736 [debug] [MainThread]: On master: COMMIT
[0m22:24:02.178254 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:02.178536 [debug] [MainThread]: On master: COMMIT
[0m22:24:02.216145 [debug] [MainThread]: SQL status: COMMIT in 0.037 seconds
[0m22:24:02.216578 [debug] [MainThread]: On master: Close
[0m22:24:02.224335 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m22:24:02.225132 [info ] [Thread-1 (]: 1 of 1 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m22:24:02.226445 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m22:24:02.227573 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m22:24:02.234700 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m22:24:02.236018 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m22:24:02.271552 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m22:24:02.272833 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:24:02.273236 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    split_part(log, ' ', 1) as ip,

    -- TIMESTAMP
    to_timestamp(
        trim(
            replace(
                split_part(split_part(log, '[', 2), ']', 1),
                ' ',
                ''
            )
        ),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- requête complète
    substring(log from '"([^"]+)"') as request,

    -- méthode HTTP
    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    -- page
    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    -- page normalisée (sans slash final)
    regexp_replace(
        lower(split_part(substring(log from '"([^"]+)"'), ' ', 2)),
        '/$',
        ''
    ) as page_clean,

    -- status code
    split_part(log, ' ', 9)::int as status_code,

    -- referer (URL complète)
    split_part(log, '"', 4) as referer,

    -- host du referer
    split_part(
        regexp_replace(split_part(log, '"', 4), '^https?://', ''),
        '/',
        1
    ) as referer_host,

    -- user agent
    split_part(log, '"', 6) as user_agent,

    -- détection bot (technique, pas métier)
    split_part(log, '"', 6) ilike '%bot%' as is_bot

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m22:24:02.273538 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:42.911637 [debug] [Thread-1 (]: SQL status: SELECT 236692 in 40.638 seconds
[0m22:24:42.933220 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:24:42.934107 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m22:24:42.957833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m22:24:42.961510 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:24:42.961992 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m22:24:42.984729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m22:24:42.996931 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m22:24:42.997370 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:24:42.997612 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m22:24:43.019909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m22:24:43.080889 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m22:24:43.086904 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:24:43.087299 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m22:24:43.119924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m22:24:43.122278 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m22:24:43.126356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7c80062-33ef-47e6-9a7b-4ca465537b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED9FCBC50>]}
[0m22:24:43.127012 [info ] [Thread-1 (]: 1 of 1 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 236692[0m in 40.90s]
[0m22:24:43.127731 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m22:24:43.133454 [debug] [MainThread]: On master: COMMIT
[0m22:24:43.134009 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:43.134704 [debug] [MainThread]: On master: COMMIT
[0m22:24:43.135111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:43.300941 [debug] [MainThread]: SQL status: COMMIT in 0.166 seconds
[0m22:24:43.301282 [debug] [MainThread]: On master: Close
[0m22:24:43.301685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:43.301922 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m22:24:43.302093 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m22:24:43.302248 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m22:24:43.302447 [info ] [MainThread]: 
[0m22:24:43.303005 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 45.52 seconds (45.52s).
[0m22:24:43.304049 [debug] [MainThread]: Command end result
[0m22:24:43.318400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:24:43.322054 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:24:43.329628 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m22:24:43.329991 [info ] [MainThread]: 
[0m22:24:43.330652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:43.331474 [info ] [MainThread]: 
[0m22:24:43.332029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:24:43.332859 [debug] [MainThread]: Command `dbt run` succeeded at 22:24:43.332769 after 48.25 seconds
[0m22:24:43.333117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA144D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA3B7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDA3B7570>]}
[0m22:24:43.333352 [debug] [MainThread]: Flushing usage events
[0m22:24:44.064153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:25:58.939489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F429D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F1DE4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F6413C50>]}


============================== 22:25:58.944230 | a9f44645-aa8b-4e19-8628-a99d878f271a ==============================
[0m22:25:58.944230 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:25:58.945226 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs generate --profile essenam', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:25:59.093127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9f44645-aa8b-4e19-8628-a99d878f271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F4731F30>]}
[0m22:25:59.143243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9f44645-aa8b-4e19-8628-a99d878f271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F52BFDF0>]}
[0m22:25:59.144708 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:25:59.306549 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m22:25:59.396494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:25:59.396921 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:25:59.397184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:25:59.420677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9f44645-aa8b-4e19-8628-a99d878f271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F6C49A50>]}
[0m22:25:59.478281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9f44645-aa8b-4e19-8628-a99d878f271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F6DC5130>]}
[0m22:25:59.478734 [info ] [MainThread]: Found 1 model, 1 source, 467 macros
[0m22:25:59.479338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f44645-aa8b-4e19-8628-a99d878f271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F6D4FBD0>]}
[0m22:25:59.481391 [info ] [MainThread]: 
[0m22:25:59.481899 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m22:25:59.482357 [info ] [MainThread]: 
[0m22:25:59.482898 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:25:59.483649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m22:25:59.544264 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m22:25:59.544619 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m22:25:59.544921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:59.746178 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.201 seconds
[0m22:25:59.747488 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m22:25:59.769955 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m22:25:59.774344 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:59.774745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:25:59.775029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:25:59.968283 [debug] [MainThread]: SQL status: SELECT 1 in 0.193 seconds
[0m22:25:59.969338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f44645-aa8b-4e19-8628-a99d878f271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F6F63A00>]}
[0m22:25:59.969682 [debug] [MainThread]: On master: ROLLBACK
[0m22:25:59.991227 [debug] [MainThread]: On master: Close
[0m22:25:59.997695 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m22:25:59.998345 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m22:25:59.998676 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m22:26:00.005096 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m22:26:00.006461 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m22:26:00.007383 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m22:26:00.010768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:00.011217 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m22:26:00.011477 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m22:26:00.012055 [debug] [MainThread]: Command end result
[0m22:26:00.072058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:26:00.074355 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:26:00.079947 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m22:26:00.541448 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:26:00.541820 [info ] [MainThread]: Building catalog
[0m22:26:00.550017 [debug] [ThreadPool]: Acquiring new postgres connection 'wintershop_student.information_schema'
[0m22:26:00.556607 [debug] [ThreadPool]: Using postgres connection "wintershop_student.information_schema"
[0m22:26:00.557315 [debug] [ThreadPool]: On wintershop_student.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "wintershop_student.information_schema"} */

    
    

    select
        'wintershop_student' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wintershop_essenam') and
           upper(tbl.relname) = upper('stg_logs')) or (upper(sch.nspname) = upper('wintershop_prod') and
           upper(tbl.relname) = upper('bronze')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:26:00.557707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:00.739207 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.181 seconds
[0m22:26:00.741083 [debug] [ThreadPool]: On wintershop_student.information_schema: ROLLBACK
[0m22:26:00.761060 [debug] [ThreadPool]: On wintershop_student.information_schema: Close
[0m22:26:00.769210 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\catalog.json
[0m22:26:00.783198 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:26:00.785394 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:26:00.785728 [info ] [MainThread]: Catalog written to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\catalog.json
[0m22:26:00.787161 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:26:00.787015 after 2.01 seconds
[0m22:26:00.787417 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:26:00.787589 [debug] [MainThread]: Connection 'wintershop_student.information_schema' was properly closed.
[0m22:26:00.787787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F50E7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F7189910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166F7189D30>]}
[0m22:26:00.788058 [debug] [MainThread]: Flushing usage events
[0m22:26:01.470902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:17.384232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D69B6D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D676B4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6AD0BC50>]}


============================== 22:26:17.388396 | e27bec3c-42d9-423c-a37c-ae226c5398b7 ==============================
[0m22:26:17.388396 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:26:17.389227 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve --profile essenam', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:26:17.540540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e27bec3c-42d9-423c-a37c-ae226c5398b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6A001F30>]}
[0m22:26:17.588802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e27bec3c-42d9-423c-a37c-ae226c5398b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6AB8FF00>]}
[0m22:39:59.436237 [error] [MainThread]: Encountered an error:

[0m22:39:59.481107 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\selectors.py", line 314, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\selectors.py", line 305, in _select
    r, w, x = select.select(r, w, w, timeout)
              ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m22:39:59.482914 [debug] [MainThread]: Command `dbt docs serve` failed at 22:39:59.482767 after 822.24 seconds
[0m22:39:59.483621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6C467050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6C467150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6C4998B0>]}
[0m22:39:59.484442 [debug] [MainThread]: Flushing usage events
[0m22:40:00.111562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:15.113590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA5D7D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA38E4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA6F23C50>]}


============================== 22:40:15.117132 | 67b22a5e-467f-44c5-b07a-92fd8007346d ==============================
[0m22:40:15.117132 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:40:15.117909 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profile essenam', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:40:15.244319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA6211F30>]}
[0m22:40:15.285250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA6D9FDF0>]}
[0m22:40:15.286638 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:40:15.447085 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m22:40:15.531035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:40:15.531439 [debug] [MainThread]: Partial parsing: added file: wintershop://models\silver\silver.sql
[0m22:40:15.699018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA86F4150>]}
[0m22:40:15.783164 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:40:15.785443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:40:15.806271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA2D27890>]}
[0m22:40:15.806701 [info ] [MainThread]: Found 2 models, 1 source, 467 macros
[0m22:40:15.807347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA8432190>]}
[0m22:40:15.808647 [info ] [MainThread]: 
[0m22:40:15.809219 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m22:40:15.809725 [info ] [MainThread]: 
[0m22:40:15.810236 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:15.812947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m22:40:15.861598 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m22:40:15.861926 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m22:40:15.862149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:16.036029 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.174 seconds
[0m22:40:16.037592 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m22:40:16.039414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m22:40:16.043226 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m22:40:16.043495 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m22:40:16.043831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:16.213677 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.170 seconds
[0m22:40:16.215048 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m22:40:16.236110 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m22:40:16.244390 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:16.244819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:40:16.245160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:16.423023 [debug] [MainThread]: SQL status: SELECT 1 in 0.178 seconds
[0m22:40:16.424186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA8C8CA10>]}
[0m22:40:16.424645 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:16.446304 [debug] [MainThread]: On master: COMMIT
[0m22:40:16.446832 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:16.447176 [debug] [MainThread]: On master: COMMIT
[0m22:40:16.491507 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m22:40:16.492453 [debug] [MainThread]: On master: Close
[0m22:40:16.503925 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m22:40:16.504387 [info ] [Thread-1 (]: 1 of 2 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m22:40:16.505265 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m22:40:16.505555 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m22:40:16.510270 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m22:40:16.511076 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m22:40:16.538521 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m22:40:16.539457 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:40:16.539824 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    split_part(log, ' ', 1) as ip,

    -- TIMESTAMP
    to_timestamp(
        trim(
            replace(
                split_part(split_part(log, '[', 2), ']', 1),
                ' ',
                ''
            )
        ),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- requête complète
    substring(log from '"([^"]+)"') as request,

    -- méthode HTTP
    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    -- page
    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    -- page normalisée (sans slash final)
    regexp_replace(
        lower(split_part(substring(log from '"([^"]+)"'), ' ', 2)),
        '/$',
        ''
    ) as page_clean,

    -- status code
    split_part(log, ' ', 9)::int as status_code,

    -- referer (URL complète)
    split_part(log, '"', 4) as referer,

    -- host du referer
    split_part(
        regexp_replace(split_part(log, '"', 4), '^https?://', ''),
        '/',
        1
    ) as referer_host,

    -- user agent
    split_part(log, '"', 6) as user_agent,

    -- détection bot (technique, pas métier)
    split_part(log, '"', 6) ilike '%bot%' as is_bot

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m22:40:16.540079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:16.734830 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.194 seconds
[0m22:40:16.744908 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:40:16.745287 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m22:40:16.767622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m22:40:16.770918 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:40:16.771301 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m22:40:16.793749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m22:40:16.808212 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m22:40:16.808538 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:40:16.808782 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m22:40:16.831541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m22:40:16.836627 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m22:40:16.839425 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:40:16.839715 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m22:40:16.872681 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m22:40:16.876210 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m22:40:16.878462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA8D40950>]}
[0m22:40:16.878930 [info ] [Thread-1 (]: 1 of 2 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 0[0m in 0.37s]
[0m22:40:16.879904 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m22:40:16.880824 [debug] [Thread-2 (]: Began running node model.wintershop.silver
[0m22:40:16.881190 [info ] [Thread-2 (]: 2 of 2 START sql table model wintershop_essenam.silver ......................... [RUN]
[0m22:40:16.881899 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.wintershop.silver'
[0m22:40:16.882217 [debug] [Thread-2 (]: Began compiling node model.wintershop.silver
[0m22:40:16.883862 [debug] [Thread-2 (]: Writing injected SQL for node "model.wintershop.silver"
[0m22:40:16.884626 [debug] [Thread-2 (]: Began executing node model.wintershop.silver
[0m22:40:16.886713 [debug] [Thread-2 (]: Writing runtime sql for node "model.wintershop.silver"
[0m22:40:16.887638 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:40:16.888013 [debug] [Thread-2 (]: On model.wintershop.silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.silver"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."silver__dbt_tmp"
  
  
    as
  
  (
    

select
    ip,
    event_ts,
    request,
    http_method,
    page,
    page_clean,
    status_code,
    referer,
    referer_host,
    user_agent,
    is_bot
from "wintershop_student"."wintershop_essenam"."stg_logs"
  );
  
[0m22:40:16.888297 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:40:17.055469 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.167 seconds
[0m22:40:17.060584 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:40:17.061169 [debug] [Thread-2 (]: On model.wintershop.silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.silver"} */
alter table "wintershop_student"."wintershop_essenam"."silver__dbt_tmp" rename to "silver"
[0m22:40:17.082287 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m22:40:17.085058 [debug] [Thread-2 (]: On model.wintershop.silver: COMMIT
[0m22:40:17.085790 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:40:17.086334 [debug] [Thread-2 (]: On model.wintershop.silver: COMMIT
[0m22:40:17.108112 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m22:40:17.111886 [debug] [Thread-2 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."silver__dbt_backup"
[0m22:40:17.113389 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:40:17.113922 [debug] [Thread-2 (]: On model.wintershop.silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.silver"} */
drop table if exists "wintershop_student"."wintershop_essenam"."silver__dbt_backup" cascade
[0m22:40:17.134231 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.020 seconds
[0m22:40:17.135581 [debug] [Thread-2 (]: On model.wintershop.silver: Close
[0m22:40:17.136099 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b22a5e-467f-44c5-b07a-92fd8007346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA88624C0>]}
[0m22:40:17.136596 [info ] [Thread-2 (]: 2 of 2 OK created sql table model wintershop_essenam.silver .................... [[32mSELECT 0[0m in 0.25s]
[0m22:40:17.137591 [debug] [Thread-2 (]: Finished running node model.wintershop.silver
[0m22:40:17.141041 [debug] [MainThread]: On master: COMMIT
[0m22:40:17.141304 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:17.141506 [debug] [MainThread]: On master: COMMIT
[0m22:40:17.141689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:17.306037 [debug] [MainThread]: SQL status: COMMIT in 0.164 seconds
[0m22:40:17.306734 [debug] [MainThread]: On master: Close
[0m22:40:17.307400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:17.307775 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m22:40:17.308047 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m22:40:17.308273 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m22:40:17.308491 [debug] [MainThread]: Connection 'model.wintershop.silver' was properly closed.
[0m22:40:17.308807 [info ] [MainThread]: 
[0m22:40:17.309635 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m22:40:17.310836 [debug] [MainThread]: Command end result
[0m22:40:17.323474 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:40:17.325290 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:40:17.331059 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m22:40:17.331457 [info ] [MainThread]: 
[0m22:40:17.332686 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:17.334011 [info ] [MainThread]: 
[0m22:40:17.334824 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:40:17.336385 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:17.336261 after 2.36 seconds
[0m22:40:17.336678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA87445F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA8447410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA5C6CF50>]}
[0m22:40:17.337063 [debug] [MainThread]: Flushing usage events
[0m22:40:17.979497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:15.753861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481CD7D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481A8C4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481EEF3C50>]}


============================== 22:52:15.759005 | 710f525d-5146-44ed-bf8d-0bda29793b9b ==============================
[0m22:52:15.759005 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:52:15.759842 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profile essenam', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:52:15.920512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481D211F30>]}
[0m22:52:15.974833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481DD9FDF0>]}
[0m22:52:15.976671 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:52:16.164598 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m22:52:16.367214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:52:16.367740 [debug] [MainThread]: Partial parsing: added file: wintershop://models\silver\schema.yml
[0m22:52:16.512203 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'silver' in
package 'wintershop' (models\silver\schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m22:52:16.513681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481F794450>]}
[0m22:52:16.653914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481F7EA6C0>]}
[0m22:52:16.731169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:52:16.733665 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:52:16.767557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481F4C9550>]}
[0m22:52:16.768049 [info ] [MainThread]: Found 2 models, 7 data tests, 1 source, 467 macros
[0m22:52:16.768781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481FB0A270>]}
[0m22:52:16.770303 [info ] [MainThread]: 
[0m22:52:16.770854 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m22:52:16.771388 [info ] [MainThread]: 
[0m22:52:16.772130 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:52:16.776649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student'
[0m22:52:16.841813 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student"
[0m22:52:16.842138 [debug] [ThreadPool]: On list_wintershop_student: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student"} */

    select distinct nspname from pg_namespace
  
[0m22:52:16.842390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:17.010091 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.168 seconds
[0m22:52:17.011085 [debug] [ThreadPool]: On list_wintershop_student: Close
[0m22:52:17.013075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m22:52:17.016700 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m22:52:17.016994 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m22:52:17.017256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:17.208157 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.191 seconds
[0m22:52:17.209487 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m22:52:17.230774 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m22:52:17.238556 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:17.239035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:52:17.239551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:17.422631 [debug] [MainThread]: SQL status: SELECT 1 in 0.183 seconds
[0m22:52:17.423758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481FD38890>]}
[0m22:52:17.424115 [debug] [MainThread]: On master: ROLLBACK
[0m22:52:17.445590 [debug] [MainThread]: On master: COMMIT
[0m22:52:17.446194 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:17.446494 [debug] [MainThread]: On master: COMMIT
[0m22:52:17.489567 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m22:52:17.489924 [debug] [MainThread]: On master: Close
[0m22:52:17.498456 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m22:52:17.498954 [info ] [Thread-1 (]: 1 of 2 START sql table model wintershop_essenam.stg_logs ....................... [RUN]
[0m22:52:17.499724 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m22:52:17.500001 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m22:52:17.504863 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m22:52:17.505636 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m22:52:17.532921 [debug] [Thread-1 (]: Writing runtime sql for node "model.wintershop.stg_logs"
[0m22:52:17.534921 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:52:17.535514 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp"
  
  
    as
  
  (
    

select
    log,

    -- IP
    split_part(log, ' ', 1) as ip,

    -- TIMESTAMP
    to_timestamp(
        trim(
            replace(
                split_part(split_part(log, '[', 2), ']', 1),
                ' ',
                ''
            )
        ),
        'DD/Mon/YYYY:HH24:MI:SS'
    ) as event_ts,

    -- requête complète
    substring(log from '"([^"]+)"') as request,

    -- méthode HTTP
    split_part(substring(log from '"([^"]+)"'), ' ', 1) as http_method,

    -- page
    split_part(substring(log from '"([^"]+)"'), ' ', 2) as page,

    -- page normalisée (sans slash final)
    regexp_replace(
        lower(split_part(substring(log from '"([^"]+)"'), ' ', 2)),
        '/$',
        ''
    ) as page_clean,

    -- status code
    split_part(log, ' ', 9)::int as status_code,

    -- referer (URL complète)
    split_part(log, '"', 4) as referer,

    -- host du referer
    split_part(
        regexp_replace(split_part(log, '"', 4), '^https?://', ''),
        '/',
        1
    ) as referer_host,

    -- user agent
    split_part(log, '"', 6) as user_agent,

    -- détection bot (technique, pas métier)
    split_part(log, '"', 6) ilike '%bot%' as is_bot

from "wintershop_student"."wintershop_prod"."bronze"
  );
  
[0m22:52:17.535896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:17.697203 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.161 seconds
[0m22:52:17.706194 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:52:17.706649 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs" rename to "stg_logs__dbt_backup"
[0m22:52:17.728609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m22:52:17.731362 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:52:17.731704 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
alter table "wintershop_student"."wintershop_essenam"."stg_logs__dbt_tmp" rename to "stg_logs"
[0m22:52:17.752547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m22:52:17.764114 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m22:52:17.764522 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:52:17.764796 [debug] [Thread-1 (]: On model.wintershop.stg_logs: COMMIT
[0m22:52:17.785979 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m22:52:17.791775 [debug] [Thread-1 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup"
[0m22:52:17.795210 [debug] [Thread-1 (]: Using postgres connection "model.wintershop.stg_logs"
[0m22:52:17.795489 [debug] [Thread-1 (]: On model.wintershop.stg_logs: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.stg_logs"} */
drop table if exists "wintershop_student"."wintershop_essenam"."stg_logs__dbt_backup" cascade
[0m22:52:17.819699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.024 seconds
[0m22:52:17.821553 [debug] [Thread-1 (]: On model.wintershop.stg_logs: Close
[0m22:52:17.823536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481FE64100>]}
[0m22:52:17.823985 [info ] [Thread-1 (]: 1 of 2 OK created sql table model wintershop_essenam.stg_logs .................. [[32mSELECT 0[0m in 0.32s]
[0m22:52:17.824840 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m22:52:17.825809 [debug] [Thread-2 (]: Began running node model.wintershop.silver
[0m22:52:17.826157 [info ] [Thread-2 (]: 2 of 2 START sql table model wintershop_essenam.silver ......................... [RUN]
[0m22:52:17.827060 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.wintershop.silver'
[0m22:52:17.827548 [debug] [Thread-2 (]: Began compiling node model.wintershop.silver
[0m22:52:17.829298 [debug] [Thread-2 (]: Writing injected SQL for node "model.wintershop.silver"
[0m22:52:17.830018 [debug] [Thread-2 (]: Began executing node model.wintershop.silver
[0m22:52:17.832008 [debug] [Thread-2 (]: Writing runtime sql for node "model.wintershop.silver"
[0m22:52:17.832693 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:52:17.832982 [debug] [Thread-2 (]: On model.wintershop.silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.silver"} */

  
    

  create  table "wintershop_student"."wintershop_essenam"."silver__dbt_tmp"
  
  
    as
  
  (
    

select
    ip,
    event_ts,
    request,
    http_method,
    page,
    page_clean,
    status_code,
    referer,
    referer_host,
    user_agent,
    is_bot
from "wintershop_student"."wintershop_essenam"."stg_logs"
  );
  
[0m22:52:17.833211 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:52:18.021337 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.188 seconds
[0m22:52:18.024492 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:52:18.024855 [debug] [Thread-2 (]: On model.wintershop.silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.silver"} */
alter table "wintershop_student"."wintershop_essenam"."silver" rename to "silver__dbt_backup"
[0m22:52:18.047254 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m22:52:18.049918 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:52:18.050237 [debug] [Thread-2 (]: On model.wintershop.silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.silver"} */
alter table "wintershop_student"."wintershop_essenam"."silver__dbt_tmp" rename to "silver"
[0m22:52:18.075379 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m22:52:18.076889 [debug] [Thread-2 (]: On model.wintershop.silver: COMMIT
[0m22:52:18.077280 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:52:18.077571 [debug] [Thread-2 (]: On model.wintershop.silver: COMMIT
[0m22:52:18.100114 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m22:52:18.101853 [debug] [Thread-2 (]: Applying DROP to: "wintershop_student"."wintershop_essenam"."silver__dbt_backup"
[0m22:52:18.102357 [debug] [Thread-2 (]: Using postgres connection "model.wintershop.silver"
[0m22:52:18.102614 [debug] [Thread-2 (]: On model.wintershop.silver: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "node_id": "model.wintershop.silver"} */
drop table if exists "wintershop_student"."wintershop_essenam"."silver__dbt_backup" cascade
[0m22:52:18.128697 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.026 seconds
[0m22:52:18.130080 [debug] [Thread-2 (]: On model.wintershop.silver: Close
[0m22:52:18.130910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710f525d-5146-44ed-bf8d-0bda29793b9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481FEDC410>]}
[0m22:52:18.131890 [info ] [Thread-2 (]: 2 of 2 OK created sql table model wintershop_essenam.silver .................... [[32mSELECT 0[0m in 0.30s]
[0m22:52:18.133183 [debug] [Thread-2 (]: Finished running node model.wintershop.silver
[0m22:52:18.137036 [debug] [MainThread]: On master: COMMIT
[0m22:52:18.137424 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:18.137688 [debug] [MainThread]: On master: COMMIT
[0m22:52:18.137883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:52:18.285635 [debug] [MainThread]: SQL status: COMMIT in 0.148 seconds
[0m22:52:18.286299 [debug] [MainThread]: On master: Close
[0m22:52:18.286944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:18.287320 [debug] [MainThread]: Connection 'list_wintershop_student' was properly closed.
[0m22:52:18.287594 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m22:52:18.287843 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m22:52:18.288066 [debug] [MainThread]: Connection 'model.wintershop.silver' was properly closed.
[0m22:52:18.288380 [info ] [MainThread]: 
[0m22:52:18.289177 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m22:52:18.290316 [debug] [MainThread]: Command end result
[0m22:52:18.303602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:52:18.305632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:52:18.311690 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m22:52:18.312835 [info ] [MainThread]: 
[0m22:52:18.315609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:52:18.316583 [info ] [MainThread]: 
[0m22:52:18.317448 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:52:18.318727 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:52:18.321089 [debug] [MainThread]: Command `dbt run` succeeded at 22:52:18.320765 after 2.74 seconds
[0m22:52:18.321999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481CC85DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481AB5A0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481EEF6D60>]}
[0m22:52:18.322922 [debug] [MainThread]: Flushing usage events
[0m22:52:18.988692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:32.223409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9B6ED160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99224190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9C88FC50>]}


============================== 22:53:32.230352 | 42c167e6-bf93-4586-9fc8-8079b734d7cd ==============================
[0m22:53:32.230352 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:53:32.231329 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt docs generate --profile essenam', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:53:32.386863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42c167e6-bf93-4586-9fc8-8079b734d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9BB81F30>]}
[0m22:53:32.437644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42c167e6-bf93-4586-9fc8-8079b734d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9C70FDF0>]}
[0m22:53:32.439301 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:53:32.635963 [debug] [MainThread]: checksum: 57bae826d44a552a417b20a66ee7eea8f9113bcc654d7c53b7e29f47d1a0996c, vars: {}, profile: essenam, target: , version: 1.11.2
[0m22:53:32.766638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:32.766948 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:53:32.767144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:32.800342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c167e6-bf93-4586-9fc8-8079b734d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9E007650>]}
[0m22:53:32.830199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c167e6-bf93-4586-9fc8-8079b734d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9E2B9310>]}
[0m22:53:32.830828 [info ] [MainThread]: Found 2 models, 7 data tests, 1 source, 467 macros
[0m22:53:32.831982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c167e6-bf93-4586-9fc8-8079b734d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9E207BD0>]}
[0m22:53:32.834231 [info ] [MainThread]: 
[0m22:53:32.834979 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m22:53:32.835466 [info ] [MainThread]: 
[0m22:53:32.836050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:53:32.838990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_wintershop_student_wintershop_essenam'
[0m22:53:32.909431 [debug] [ThreadPool]: Using postgres connection "list_wintershop_student_wintershop_essenam"
[0m22:53:32.909911 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "list_wintershop_student_wintershop_essenam"} */
select
      'wintershop_student' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wintershop_essenam'
    union all
    select
      'wintershop_student' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wintershop_essenam'
  
[0m22:53:32.910245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:33.119778 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.209 seconds
[0m22:53:33.121077 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: ROLLBACK
[0m22:53:33.142630 [debug] [ThreadPool]: On list_wintershop_student_wintershop_essenam: Close
[0m22:53:33.147215 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:33.147559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:53:33.147853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:33.325222 [debug] [MainThread]: SQL status: SELECT 1 in 0.177 seconds
[0m22:53:33.326685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c167e6-bf93-4586-9fc8-8079b734d7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9E4E8D50>]}
[0m22:53:33.327201 [debug] [MainThread]: On master: ROLLBACK
[0m22:53:33.347962 [debug] [MainThread]: On master: Close
[0m22:53:33.358905 [debug] [Thread-1 (]: Began running node model.wintershop.stg_logs
[0m22:53:33.359530 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.wintershop.stg_logs'
[0m22:53:33.359877 [debug] [Thread-1 (]: Began compiling node model.wintershop.stg_logs
[0m22:53:33.366508 [debug] [Thread-1 (]: Writing injected SQL for node "model.wintershop.stg_logs"
[0m22:53:33.367735 [debug] [Thread-1 (]: Began executing node model.wintershop.stg_logs
[0m22:53:33.368590 [debug] [Thread-1 (]: Finished running node model.wintershop.stg_logs
[0m22:53:33.369741 [debug] [Thread-2 (]: Began running node model.wintershop.silver
[0m22:53:33.370537 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.wintershop.silver'
[0m22:53:33.370940 [debug] [Thread-2 (]: Began compiling node model.wintershop.silver
[0m22:53:33.373718 [debug] [Thread-2 (]: Writing injected SQL for node "model.wintershop.silver"
[0m22:53:33.374917 [debug] [Thread-2 (]: Began executing node model.wintershop.silver
[0m22:53:33.375772 [debug] [Thread-2 (]: Finished running node model.wintershop.silver
[0m22:53:33.376915 [debug] [Thread-7 (]: Began running node test.wintershop.not_null_silver_ip.8197d890dc
[0m22:53:33.377395 [debug] [Thread-3 (]: Began running node test.wintershop.accepted_values_silver_http_method__GET__POST__PUT__DELETE__HEAD__OPTIONS.884931ec37
[0m22:53:33.377888 [debug] [Thread-5 (]: Began running node test.wintershop.not_null_silver_event_ts.e95b31f78c
[0m22:53:33.378480 [debug] [Thread-6 (]: Began running node test.wintershop.not_null_silver_http_method.7c8ec234a3
[0m22:53:33.379352 [debug] [Thread-8 (]: Began running node test.wintershop.not_null_silver_is_bot.aa42818a7b
[0m22:53:33.379898 [debug] [Thread-9 (]: Began running node test.wintershop.not_null_silver_status_code.02f3b02097
[0m22:53:33.380714 [debug] [Thread-7 (]: Acquiring new postgres connection 'test.wintershop.not_null_silver_ip.8197d890dc'
[0m22:53:33.381275 [debug] [Thread-4 (]: Began running node test.wintershop.accepted_values_silver_status_code__200__301__302__400__401__403__404__500__503.787b9dcda7
[0m22:53:33.382136 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.wintershop.accepted_values_silver_http_method__GET__POST__PUT__DELETE__HEAD__OPTIONS.884931ec37'
[0m22:53:33.383044 [debug] [Thread-5 (]: Acquiring new postgres connection 'test.wintershop.not_null_silver_event_ts.e95b31f78c'
[0m22:53:33.383850 [debug] [Thread-6 (]: Acquiring new postgres connection 'test.wintershop.not_null_silver_http_method.7c8ec234a3'
[0m22:53:33.384638 [debug] [Thread-8 (]: Acquiring new postgres connection 'test.wintershop.not_null_silver_is_bot.aa42818a7b'
[0m22:53:33.385421 [debug] [Thread-9 (]: Acquiring new postgres connection 'test.wintershop.not_null_silver_status_code.02f3b02097'
[0m22:53:33.385961 [debug] [Thread-7 (]: Began compiling node test.wintershop.not_null_silver_ip.8197d890dc
[0m22:53:33.386695 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.wintershop.accepted_values_silver_status_code__200__301__302__400__401__403__404__500__503.787b9dcda7'
[0m22:53:33.387213 [debug] [Thread-3 (]: Began compiling node test.wintershop.accepted_values_silver_http_method__GET__POST__PUT__DELETE__HEAD__OPTIONS.884931ec37
[0m22:53:33.387815 [debug] [Thread-5 (]: Began compiling node test.wintershop.not_null_silver_event_ts.e95b31f78c
[0m22:53:33.388692 [debug] [Thread-6 (]: Began compiling node test.wintershop.not_null_silver_http_method.7c8ec234a3
[0m22:53:33.389554 [debug] [Thread-8 (]: Began compiling node test.wintershop.not_null_silver_is_bot.aa42818a7b
[0m22:53:33.390217 [debug] [Thread-9 (]: Began compiling node test.wintershop.not_null_silver_status_code.02f3b02097
[0m22:53:33.402702 [debug] [Thread-7 (]: Writing injected SQL for node "test.wintershop.not_null_silver_ip.8197d890dc"
[0m22:53:33.403477 [debug] [Thread-4 (]: Began compiling node test.wintershop.accepted_values_silver_status_code__200__301__302__400__401__403__404__500__503.787b9dcda7
[0m22:53:33.414756 [debug] [Thread-3 (]: Writing injected SQL for node "test.wintershop.accepted_values_silver_http_method__GET__POST__PUT__DELETE__HEAD__OPTIONS.884931ec37"
[0m22:53:33.417410 [debug] [Thread-5 (]: Writing injected SQL for node "test.wintershop.not_null_silver_event_ts.e95b31f78c"
[0m22:53:33.420359 [debug] [Thread-6 (]: Writing injected SQL for node "test.wintershop.not_null_silver_http_method.7c8ec234a3"
[0m22:53:33.424740 [debug] [Thread-8 (]: Writing injected SQL for node "test.wintershop.not_null_silver_is_bot.aa42818a7b"
[0m22:53:33.429402 [debug] [Thread-9 (]: Writing injected SQL for node "test.wintershop.not_null_silver_status_code.02f3b02097"
[0m22:53:33.433041 [debug] [Thread-4 (]: Writing injected SQL for node "test.wintershop.accepted_values_silver_status_code__200__301__302__400__401__403__404__500__503.787b9dcda7"
[0m22:53:33.435556 [debug] [Thread-3 (]: Began executing node test.wintershop.accepted_values_silver_http_method__GET__POST__PUT__DELETE__HEAD__OPTIONS.884931ec37
[0m22:53:33.436309 [debug] [Thread-3 (]: Finished running node test.wintershop.accepted_values_silver_http_method__GET__POST__PUT__DELETE__HEAD__OPTIONS.884931ec37
[0m22:53:33.437039 [debug] [Thread-5 (]: Began executing node test.wintershop.not_null_silver_event_ts.e95b31f78c
[0m22:53:33.437568 [debug] [Thread-7 (]: Began executing node test.wintershop.not_null_silver_ip.8197d890dc
[0m22:53:33.439204 [debug] [Thread-5 (]: Finished running node test.wintershop.not_null_silver_event_ts.e95b31f78c
[0m22:53:33.440998 [debug] [Thread-7 (]: Finished running node test.wintershop.not_null_silver_ip.8197d890dc
[0m22:53:33.442653 [debug] [Thread-9 (]: Began executing node test.wintershop.not_null_silver_status_code.02f3b02097
[0m22:53:33.443609 [debug] [Thread-6 (]: Began executing node test.wintershop.not_null_silver_http_method.7c8ec234a3
[0m22:53:33.444222 [debug] [Thread-8 (]: Began executing node test.wintershop.not_null_silver_is_bot.aa42818a7b
[0m22:53:33.444586 [debug] [Thread-4 (]: Began executing node test.wintershop.accepted_values_silver_status_code__200__301__302__400__401__403__404__500__503.787b9dcda7
[0m22:53:33.445215 [debug] [Thread-9 (]: Finished running node test.wintershop.not_null_silver_status_code.02f3b02097
[0m22:53:33.445834 [debug] [Thread-6 (]: Finished running node test.wintershop.not_null_silver_http_method.7c8ec234a3
[0m22:53:33.446383 [debug] [Thread-8 (]: Finished running node test.wintershop.not_null_silver_is_bot.aa42818a7b
[0m22:53:33.446962 [debug] [Thread-4 (]: Finished running node test.wintershop.accepted_values_silver_status_code__200__301__302__400__401__403__404__500__503.787b9dcda7
[0m22:53:33.449499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:33.449773 [debug] [MainThread]: Connection 'list_wintershop_student_wintershop_essenam' was properly closed.
[0m22:53:33.449963 [debug] [MainThread]: Connection 'model.wintershop.stg_logs' was properly closed.
[0m22:53:33.450139 [debug] [MainThread]: Connection 'model.wintershop.silver' was properly closed.
[0m22:53:33.450305 [debug] [MainThread]: Connection 'test.wintershop.not_null_silver_ip.8197d890dc' was properly closed.
[0m22:53:33.450485 [debug] [MainThread]: Connection 'test.wintershop.accepted_values_silver_http_method__GET__POST__PUT__DELETE__HEAD__OPTIONS.884931ec37' was properly closed.
[0m22:53:33.450664 [debug] [MainThread]: Connection 'test.wintershop.not_null_silver_event_ts.e95b31f78c' was properly closed.
[0m22:53:33.450864 [debug] [MainThread]: Connection 'test.wintershop.not_null_silver_http_method.7c8ec234a3' was properly closed.
[0m22:53:33.451054 [debug] [MainThread]: Connection 'test.wintershop.not_null_silver_is_bot.aa42818a7b' was properly closed.
[0m22:53:33.451215 [debug] [MainThread]: Connection 'test.wintershop.not_null_silver_status_code.02f3b02097' was properly closed.
[0m22:53:33.451374 [debug] [MainThread]: Connection 'test.wintershop.accepted_values_silver_status_code__200__301__302__400__401__403__404__500__503.787b9dcda7' was properly closed.
[0m22:53:33.452677 [debug] [MainThread]: Command end result
[0m22:53:33.574232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:53:33.577014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:53:33.581643 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\run_results.json
[0m22:53:33.583827 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:53:33.584072 [info ] [MainThread]: Building catalog
[0m22:53:33.590872 [debug] [ThreadPool]: Acquiring new postgres connection 'wintershop_student.information_schema'
[0m22:53:33.595464 [debug] [ThreadPool]: Using postgres connection "wintershop_student.information_schema"
[0m22:53:33.595803 [debug] [ThreadPool]: On wintershop_student.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "essenam", "target_name": "dev", "connection_name": "wintershop_student.information_schema"} */

    
    

    select
        'wintershop_student' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wintershop_essenam') and
           upper(tbl.relname) = upper('stg_logs')) or (upper(sch.nspname) = upper('wintershop_essenam') and
           upper(tbl.relname) = upper('silver')) or (upper(sch.nspname) = upper('wintershop_prod') and
           upper(tbl.relname) = upper('bronze')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:53:33.596155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:33.762860 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.167 seconds
[0m22:53:33.766057 [debug] [ThreadPool]: On wintershop_student.information_schema: ROLLBACK
[0m22:53:33.786248 [debug] [ThreadPool]: On wintershop_student.information_schema: Close
[0m22:53:33.797943 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\catalog.json
[0m22:53:33.810802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\manifest.json
[0m22:53:33.812915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\semantic_manifest.json
[0m22:53:33.813230 [info ] [MainThread]: Catalog written to C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\target\catalog.json
[0m22:53:33.814402 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:53:33.814300 after 1.76 seconds
[0m22:53:33.814669 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:53:33.814862 [debug] [MainThread]: Connection 'wintershop_student.information_schema' was properly closed.
[0m22:53:33.815076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9C537F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9E296830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9E6883C0>]}
[0m22:53:33.815320 [debug] [MainThread]: Flushing usage events
[0m22:53:34.521968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:44.419388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E44471D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E442284190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4458BBC50>]}


============================== 22:53:44.423705 | 7239cd35-ca75-47ad-92ad-e227818ff602 ==============================
[0m22:53:44.423705 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:53:44.424601 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'invocation_command': 'dbt docs serve --profile essenam', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:53:44.600659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7239cd35-ca75-47ad-92ad-e227818ff602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E444BB1F30>]}
[0m22:53:44.652703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7239cd35-ca75-47ad-92ad-e227818ff602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E44573FF00>]}
[0m22:55:16.682353 [error] [MainThread]: Encountered an error:

[0m22:55:16.738806 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 761, in __init__
    self.handle()
    ~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
KeyboardInterrupt

[0m22:55:16.740247 [debug] [MainThread]: Command `dbt docs serve` failed at 22:55:16.740130 after 92.48 seconds
[0m22:55:16.740676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E446FA3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E446FA3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E446FD99A0>]}
[0m22:55:16.741111 [debug] [MainThread]: Flushing usage events
[0m22:55:17.391594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:43.301876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8F9D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC6B64190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCA13BC50>]}


============================== 22:55:43.305449 | c76c16e5-7283-4fd4-97c2-75bc69ac9cea ==============================
[0m22:55:43.305449 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:55:43.306215 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence', 'invocation_command': 'dbt docs serve --profile essenam', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\essen\\OneDrive\\Documents\\MASTER DATA ANNEE 2\\DATALAKE\\PROJET WINTER SPORT\\Lakehouse-Projet-Essenam-Christie-Providence\\logs'}
[0m22:55:43.446726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c76c16e5-7283-4fd4-97c2-75bc69ac9cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC9431F30>]}
[0m22:55:43.490527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c76c16e5-7283-4fd4-97c2-75bc69ac9cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC9FBFF00>]}
[0m22:56:55.711066 [error] [MainThread]: Encountered an error:

[0m22:56:55.715222 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\essen\OneDrive\Documents\MASTER DATA ANNEE 2\DATALAKE\PROJET WINTER SPORT\Lakehouse-Projet-Essenam-Christie-Providence\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 761, in __init__
    self.handle()
    ~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\essen\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
KeyboardInterrupt

[0m22:56:55.717100 [debug] [MainThread]: Command `dbt docs serve` failed at 22:56:55.716951 after 72.55 seconds
[0m22:56:55.717401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCB7B3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCB7B3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCB7E99A0>]}
[0m22:56:55.717760 [debug] [MainThread]: Flushing usage events
[0m22:56:56.380642 [debug] [MainThread]: An error was encountered while trying to flush usage events
